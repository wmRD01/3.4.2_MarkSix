{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Plug/DelayTime.ts"],"names":["DelayTime","BaseSingleton","EventMng","CommandType","WebSocketEvent","EvnetType","StartDT","_time","Promise","resolve","reject","DtID","setTimeout","clearTimeout","index","connetDelay","indexOf","splice","push","StartDT_NotClear","StopAllDT","count","length","shift","SetGameHeartrate","setSecond","HeartrateNum","setInterval","getInstance","mapEvnet","get","Pulic","emit","WebSocketSendCommand","sschk","StopGameHeartrate","clearInterval"],"mappings":";;;+FASqBA,S;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAPdC,MAAAA,a;;AACAC,MAAAA,Q;;AACEC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;AAET;yBACqBL,S,GAAN,MAAMA,SAAN,SAAwB;AAAA;AAAA,2CAAxB,CAAmD;AAAA;AAAA;;AAAA,+CACjC,EADiC;;AAAA,gDAEvC,CAFuC;AAAA;;AAGjD,cAAPM,OAAO,CAACC,KAAD,EAAgB;AACzB;AAEA,iBAAO,IAAIC,OAAJ,CAAkB,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAC1C,gBAAIC,IAAI,GAAGC,UAAU,CAAC,MAAM;AACxBH,cAAAA,OAAO;AACPI,cAAAA,YAAY,CAACF,IAAD,CAAZ,CAFwB,CAGxB;;AACA,kBAAIG,KAAK,GAAG,KAAKC,WAAL,CAAiBC,OAAjB,CAAyBL,IAAzB,CAAZ;;AACA,kBAAIG,KAAK,IAAI,CAAC,CAAd,EAAiB;AACb,qBAAKC,WAAL,CAAiBE,MAAjB,CAAwBH,KAAK,GAAG,CAAhC,EAAmCA,KAAnC;AACH,eAPuB,CAQxB;;AACH,aAToB,EASlBP,KAAK,GAAG,IATU,CAArB;AAUA,iBAAKQ,WAAL,CAAiBG,IAAjB,CAAsBP,IAAtB;AACH,WAZM,CAAP;AAaH;;AACqB,cAAhBQ,gBAAgB,CAACZ,KAAD,EAAgB;AAClC;AAEA,iBAAO,IAAIC,OAAJ,CAAkB,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAC1C,gBAAIC,IAAI,GAAGC,UAAU,CAAC,MAAM;AACxBH,cAAAA,OAAO;AACPI,cAAAA,YAAY,CAACF,IAAD,CAAZ,CAFwB,CAGxB;;AACA,kBAAIG,KAAK,GAAG,KAAKC,WAAL,CAAiBC,OAAjB,CAAyBL,IAAzB,CAAZ;;AACA,kBAAIG,KAAK,IAAI,CAAC,CAAd,EAAiB;AACb,qBAAKC,WAAL,CAAiBE,MAAjB,CAAwBH,KAAK,GAAG,CAAhC,EAAmCA,KAAnC;AACH,eAPuB,CAQxB;;AACH,aAToB,EASlBP,KAAK,GAAG,IATU,CAArB;AAUH,WAXM,CAAP;AAYH;;AACDa,QAAAA,SAAS,GAAG;AACR,cAAIC,KAAK,GAAG,KAAKN,WAAL,CAAiBO,MAA7B;;AACA,eAAK,IAAIR,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGO,KAA5B,EAAmCP,KAAK,EAAxC,EAA4C;AACxC,gBAAIH,IAAI,GAAG,KAAKI,WAAL,CAAiBQ,KAAjB,EAAX;AACAV,YAAAA,YAAY,CAACF,IAAD,CAAZ;AACH;AACJ;;AAEDa,QAAAA,gBAAgB,CAACC,SAAD,EAAoB;AAChC;AACA,eAAKC,YAAL,GAAoBC,WAAW,CAAC,MAAM;AAClC;AAEA;AAAA;AAAA,sCAASC,WAAT,CAAqBC,QAArB,CAA8BC,GAA9B,CAAkC;AAAA;AAAA,wCAAUC,KAA5C,EAAmDC,IAAnD,CAAwD;AAAA;AAAA,kDAAeC,oBAAvE,EAA6F;AAAA;AAAA,4CAAYC,KAAzG,EAAgH,EAAhH;AACH,WAJ8B,EAI5BT,SAAS,GAAG,IAJgB,CAA/B;AAKH;;AACDU,QAAAA,iBAAiB,GAAG;AAChBC,UAAAA,aAAa,CAAC,KAAKV,YAAN,CAAb;AACH;;AAtD6D,O","sourcesContent":["//#region \r\n\r\nimport BaseSingleton from \"../Patten/Singleton/BaseSingleton\";\r\nimport EventMng from \"../Script/Manager/EventMng\";\r\nimport { CommandType } from \"../Script/Enum/CommandType\";\r\nimport { WebSocketEvent } from \"../Script/Enum/WebSocketEvent\";\r\nimport { EvnetType } from \"../Script/Enum/EvnetType\";\r\n\r\n//#endregion\r\nexport default class DelayTime extends BaseSingleton<DelayTime>() {\r\n    connetDelay: Array<number> = []\r\n    HeartrateNum: number = 0;\r\n    async StartDT(_time: number) {\r\n        // console.log(this.connetDelay);\r\n\r\n        return new Promise<void>((resolve, reject) => {\r\n            let DtID = setTimeout(() => {\r\n                resolve()\r\n                clearTimeout(DtID)\r\n                // for (let index = 0; index < this.connetDelay.length; index++) {\r\n                let index = this.connetDelay.indexOf(DtID)\r\n                if (index != -1) {\r\n                    this.connetDelay.splice(index - 1, index)\r\n                }\r\n                // }\r\n            }, _time * 1000)\r\n            this.connetDelay.push(DtID)\r\n        })\r\n    }\r\n    async StartDT_NotClear(_time: number) {\r\n        // console.log(this.connetDelay);\r\n\r\n        return new Promise<void>((resolve, reject) => {\r\n            let DtID = setTimeout(() => {\r\n                resolve()\r\n                clearTimeout(DtID)\r\n                // for (let index = 0; index < this.connetDelay.length; index++) {\r\n                let index = this.connetDelay.indexOf(DtID)\r\n                if (index != -1) {\r\n                    this.connetDelay.splice(index - 1, index)\r\n                }\r\n                // }\r\n            }, _time * 1000)\r\n        })\r\n    }\r\n    StopAllDT() {\r\n        let count = this.connetDelay.length\r\n        for (let index = 0; index < count; index++) {\r\n            let DtID = this.connetDelay.shift()\r\n            clearTimeout(DtID)\r\n        }\r\n    }\r\n\r\n    SetGameHeartrate(setSecond: number) {\r\n        // console.error(\"送心跳????????????\");\r\n        this.HeartrateNum = setInterval(() => {\r\n            // console.error(\"送心跳\");\r\n\r\n            EventMng.getInstance.mapEvnet.get(EvnetType.Pulic).emit(WebSocketEvent.WebSocketSendCommand, CommandType.sschk, {})\r\n        }, setSecond * 1000)\r\n    }\r\n    StopGameHeartrate() {\r\n        clearInterval(this.HeartrateNum)\r\n    }\r\n}"]}
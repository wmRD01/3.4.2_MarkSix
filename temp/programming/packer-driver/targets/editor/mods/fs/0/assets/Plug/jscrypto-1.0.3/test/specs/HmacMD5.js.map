{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Plug/jscrypto-1.0.3/test/specs/HmacMD5.js"],"names":["expect","require","Hmac","MD5","HmacMD5","Hex","Word32Array","describe","it","expectedResult","message","key","parse","toString","to","be","hmac","update","finalize","expectedMessage","expectedKey","random","nSigBytes","keyClamped","clone","clamp"],"mappings":"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","sourcesContent":["const expect = require(\"expect.js\");\nconst {Hmac, MD5, HmacMD5, Hex, Word32Array} = require(\"../../test/build\");\n\ndescribe(\"hmac-md5\", function(){\n  it(\"digest 'Hi There' as expected\", function(){\n    const expectedResult = \"9294727a3638bb1c13f48ef8158bfc9d\";\n    const message = \"Hi There\";\n    const key = Hex.parse(\"0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b\");\n    expect(HmacMD5(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest 'what do ya want for nothing?' with 'Jefe' as expected\", function(){\n    const expectedResult = \"750c783e6ab0b503eaa86e310a5db738\";\n    const message = \"what do ya want for nothing?\";\n    const key = \"Jefe\";\n    expect(HmacMD5(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest long message and key as expected\", function(){\n    const expectedResult = \"56be34521d144c88dbb8c733f0e8b3f6\";\n    const message = Hex.parse(\"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd\");\n    const key = Hex.parse(\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\");\n    expect(HmacMD5(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' with 'A' as expected\", function(){\n    const expectedResult = \"7ee2a3cc979ab19865704644ce13355c\";\n    const message = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    const key = \"A\";\n    expect(HmacMD5(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest 'abcdefghijklmnopqrstuvwxyz' with 'A' as expected\", function(){\n    const expectedResult = \"0e1bd89c43e3e6e3b3f8cf1d5ba4f77a\";\n    const message = \"abcdefghijklmnopqrstuvwxyz\";\n    const key = \"A\";\n    expect(HmacMD5(message, key).toString()).to.be(expectedResult);\n  });\n  \n  it(\"update\", function(){\n    const hmac = new Hmac(new MD5(), Hex.parse(\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"));\n    hmac.update(Hex.parse('dddddddddddddddddddddddddddddddddddd'));\n    hmac.update(Hex.parse('dddddddddddddddddddddddddddddddd'));\n    hmac.update(Hex.parse('dddddddddddddddddddddddddddddddd'));\n    \n    const message = Hex.parse(\"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd\");\n    const key = Hex.parse(\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\");\n    expect(HmacMD5(message, key).toString()).to.be(hmac.finalize().toString());\n  });\n  \n  it(\"input integrity\", function(){\n    const message = new Word32Array([0x12345678]);\n    const key = new Word32Array([0x12345678]);\n    \n    const expectedMessage = message.toString();\n    const expectedKey = key.toString();\n    \n    HmacMD5(message, key);\n    \n    expect(message.toString()).to.be(expectedMessage);\n    expect(key.toString()).to.be(expectedKey);\n  });\n  \n  it(\"respect key sigBytes\", function(){\n    const key = Word32Array.random(8);\n    key.nSigBytes = 4;\n    \n    const keyClamped = key.clone();\n    keyClamped.clamp();\n    \n    expect(HmacMD5(\"Message\", key).toString()).to.be(HmacMD5(\"Message\", keyClamped).toString());\n  });\n});\n"]}
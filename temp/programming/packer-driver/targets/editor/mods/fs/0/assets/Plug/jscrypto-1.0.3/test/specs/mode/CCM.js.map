{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Plug/jscrypto-1.0.3/test/specs/mode/CCM.js"],"names":["expect","require","Word32Array","mode","CCM","pad","NoPadding","AES","Hex","Utf8","describe","it","t","Q","N","parse","B02","getB0","toString","to","be","K","A","P","cbcMac","mac","encrypted","encrypt","iv","padding","cipherText","decrypted","decrypt","concatenatedCipherText","clone","concat","combineCipherTextAndAuthTag","combinedCiphertext","result","splitCipherTextAndAuthTag","authTag"],"mappings":"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","sourcesContent":["const expect = require(\"expect.js\");\nconst {\n  Word32Array,\n  mode: {CCM},\n  pad: {NoPadding},\n  AES,\n  Hex,\n  Utf8,\n} = require(\"../../../test/build/\");\n\ndescribe(\"mode/CCM\", function(){\n  it(\"test B0\", function(){\n    const t = 12;\n    const Q = new Word32Array([0, 17409 << 8], 7);\n    const N = Hex.parse(\"13d4a35d71a50000\");\n    const B02 = CCM.getB0(true, t, Q, N);\n    expect(B02.toString()).to.be(\"6e13d4a35d71a5000000000000004401\");\n  });\n  \n  describe(\"Klen=128, Tlen=32, Nlen=56, Alen=64, Plen=32\", function(){\n    const K = Hex.parse(\"404142434445464748494a4b4c4d4e4f\");\n    const N = Hex.parse(\"10111213141516\");\n    const A = Hex.parse(\"0001020304050607\");\n    const P = Hex.parse(\"20212223\");\n    const t = 32/8;\n  \n    it(\"test encryption/decryption/mac\", function(){\n      // Test MAC\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      expect(cbcMac.toString()).to.be(\"4dac255d\");\n    });\n  \n    it(\"test encryption/decryption\", function(){\n      // Test encryption\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      expect(encrypted.cipherText.toString()).to.be(\"7162015b\");\n    \n      // Test decryption\n      const decrypted = AES.decrypt(encrypted, K, {iv: N, mode: CCM, padding: NoPadding});\n      expect(decrypted.toString()).to.be(P.toString());\n    });\n  \n    it(\"test ciphertext/mac combining function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const concatenatedCipherText = encrypted.cipherText.clone().concat(cbcMac);\n    \n      expect(concatenatedCipherText.toString()).to.be(\"7162015b4dac255d\");\n      expect(CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac).toString()).to.be(concatenatedCipherText.toString())\n    });\n  \n    it(\"test ciphertext/mac split function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const combinedCiphertext = CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac);\n      const result = CCM.splitCipherTextAndAuthTag(combinedCiphertext, t);\n    \n      expect(result.cipherText.toString()).to.be(encrypted.cipherText.toString());\n      expect(result.authTag.toString()).to.be(cbcMac.toString());\n    });\n  });\n  \n  describe(\"Klen=128, Tlen=48, Nlen=64, Alen=128, Plen=128\", function(){\n    const K = Hex.parse(\"404142434445464748494a4b4c4d4e4f\");\n    const N = Hex.parse(\"1011121314151617\");\n    const A = Hex.parse(\"000102030405060708090a0b0c0d0e0f\");\n    const P = Hex.parse(\"202122232425262728292a2b2c2d2e2f\");\n    const t = 48/8;\n    \n    it(\"test encryption/decryption/mac\", function(){\n      // Test MAC\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      expect(cbcMac.toString()).to.be(\"1fc64fbfaccd\");\n    });\n    \n    it(\"test encryption/decryption\", function(){\n      // Test encryption\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      expect(encrypted.cipherText.toString()).to.be(\"d2a1f0e051ea5f62081a7792073d593d\");\n      \n      // Test decryption\n      const decrypted = AES.decrypt(encrypted, K, {iv: N, mode: CCM, padding: NoPadding});\n      expect(decrypted.toString()).to.be(P.toString());\n    });\n    \n    it(\"test ciphertext/mac combining function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const concatenatedCipherText = encrypted.cipherText.clone().concat(cbcMac);\n      \n      expect(concatenatedCipherText.toString()).to.be(\"d2a1f0e051ea5f62081a7792073d593d1fc64fbfaccd\");\n      expect(CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac).toString()).to.be(concatenatedCipherText.toString())\n    });\n    \n    it(\"test ciphertext/mac split function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const combinedCiphertext = CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac);\n      const result = CCM.splitCipherTextAndAuthTag(combinedCiphertext, t);\n      \n      expect(result.cipherText.toString()).to.be(encrypted.cipherText.toString());\n      expect(result.authTag.toString()).to.be(cbcMac.toString());\n    });\n  })\n  \n  describe(\"Klen=128, Tlen=64, Nlen=96, Alen=160, Plen=192\", function(){\n    const K = Hex.parse(\"404142434445464748494a4b4c4d4e4f\");\n    const N = Hex.parse(\"101112131415161718191a1b\");\n    const A = Hex.parse(\"000102030405060708090a0b0c0d0e0f10111213\");\n    const P = Hex.parse(\"202122232425262728292a2b2c2d2e2f3031323334353637\");\n    const t = 64/8;\n    \n    it(\"test encryption/decryption/mac\", function(){\n      // Test MAC\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      expect(cbcMac.toString()).to.be(\"484392fbc1b09951\");\n    });\n    \n    it(\"test encryption/decryption\", function(){\n      // Test encryption\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      expect(encrypted.cipherText.toString()).to.be(\"e3b201a9f5b71a7a9b1ceaeccd97e70b6176aad9a4428aa5\");\n      \n      // Test decryption\n      const decrypted = AES.decrypt(encrypted, K, {iv: N, mode: CCM, padding: NoPadding});\n      expect(decrypted.toString()).to.be(P.toString());\n    });\n    \n    it(\"test ciphertext/mac combining function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const concatenatedCipherText = encrypted.cipherText.clone().concat(cbcMac);\n      \n      expect(concatenatedCipherText.toString()).to.be(\"e3b201a9f5b71a7a9b1ceaeccd97e70b6176aad9a4428aa5484392fbc1b09951\");\n      expect(CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac).toString()).to.be(concatenatedCipherText.toString())\n    });\n    \n    it(\"test ciphertext/mac split function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const combinedCiphertext = CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac);\n      const result = CCM.splitCipherTextAndAuthTag(combinedCiphertext, t);\n      \n      expect(result.cipherText.toString()).to.be(encrypted.cipherText.toString());\n      expect(result.authTag.toString()).to.be(cbcMac.toString());\n    });\n  });\n\n  describe(\"Klen=128, Tlen=64, Nlen=104, Alen=0, Plen=72\", function(){\n    const K = Hex.parse(\"0953fa93e7caac9638f58820220a398e\");\n    const N = Hex.parse(\"00800148202345000012345678\");\n    const A = new Word32Array([], 0);\n    const P = Hex.parse(\"120104320308ba072f\");\n    const t = 64/8;\n    \n    it(\"test encryption/decryption/mac\", function(){\n      // Test MAC\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      expect(cbcMac.toString()).to.be(\"ec129d20a620d01e\");\n    });\n    \n    it(\"test encryption/decryption\", function(){\n      // Test encryption\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      expect(encrypted.cipherText.toString()).to.be(\"79d7dbc0c9b4d43eeb\");\n      \n      // Test decryption\n      const decrypted = AES.decrypt(encrypted, K, {iv: N, mode: CCM, padding: NoPadding});\n      expect(decrypted.toString()).to.be(P.toString());\n    });\n    \n    it(\"test ciphertext/mac combining function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const concatenatedCipherText = encrypted.cipherText.clone().concat(cbcMac);\n      \n      expect(concatenatedCipherText.toString()).to.be(\"79d7dbc0c9b4d43eebec129d20a620d01e\");\n      expect(CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac).toString()).to.be(concatenatedCipherText.toString())\n    });\n    \n    it(\"test ciphertext/mac split function\", function(){\n      const cbcMac = CCM.mac(AES, K, N, A, P, t);\n      const encrypted = AES.encrypt(P, K, { iv: N, mode: CCM, padding: NoPadding });\n      const combinedCiphertext = CCM.combineCipherTextAndAuthTag(encrypted.cipherText, cbcMac);\n      const result = CCM.splitCipherTextAndAuthTag(combinedCiphertext, t);\n      \n      expect(result.cipherText.toString()).to.be(encrypted.cipherText.toString());\n      expect(result.authTag.toString()).to.be(cbcMac.toString());\n    });\n  });\n});\n"]}
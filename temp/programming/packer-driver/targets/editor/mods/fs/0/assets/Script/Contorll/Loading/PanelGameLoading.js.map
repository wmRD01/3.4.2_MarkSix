{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Contorll/Loading/PanelGameLoading.ts"],"names":["director","find","Label","ProgressBar","Sprite","UIOpacity","_decorator","MyMath","GameEvent","GameSceneName","BaseComponent","RequestGPG","ccclass","property","PanelGameLoading","onLoad","progressBar","node","getComponent","sprite_Logo","label_progress","string","progress","setEvent","SetLogo","setLogo","CloseGameLoad","closeGameLoadAction","preloadScene","Lobby","eventProgress","bind","show","setProgressText","str","_sprite","getUI","opacity","spriteFrame","getOrg","position","eventVerificationClient","url","request","Request","method","Method","POST","body","Body","ValidateContactInfo","Phone","JSON","stringify","fetch","then","我轉資料","我拿資料囉","console","log","completedCount","totaleCount","item","divide","Math","floor","toString","response","json"],"mappings":"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","sourcesContent":["import { director, find, Label, ProgressBar, Sprite, SpriteFrame, tween, UIOpacity, v3, _decorator } from 'cc';\r\nimport MyMath from '../../../Plug/MyMath';\r\nimport { GameEvent } from '../../Enum/GameEvent';\r\nimport { GameSceneName } from '../../Enum/GameSenceName';\r\nimport BaseComponent from '../../Model/ComponentBase';\r\nimport { RequestGPG as RequestGPG } from '../Api/GPGAPI/RequestGPG';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n@ccclass('PanelGameLoading')\r\nexport default class PanelGameLoading extends BaseComponent {\r\n    progressBar: ProgressBar;\r\n    label_progress: Label;\r\n    sprite_Logo: Sprite;\r\n    onLoad() {\r\n\r\n\r\n        this.progressBar = find(\"ProgressBar\", this.node).getComponent(ProgressBar);\r\n        this.sprite_Logo = find(\"sprite_Logo\", this.node).getComponent(Sprite);\r\n        this.label_progress = find(\"con_Text/label_progress\", this.node).getComponent(Label);\r\n        this.label_progress.string = \"0%\"\r\n        this.progressBar.progress = 0\r\n        this.setEvent(GameEvent.SetLogo, this.setLogo)\r\n        this.setEvent(GameEvent.CloseGameLoad, this.closeGameLoadAction)\r\n\r\n        director.preloadScene(GameSceneName.Lobby, this.eventProgress.bind(this), () => {\r\n            /**確認資源加載完成，要如何確認呢? */\r\n        })\r\n        this.show()\r\n    }\r\n\r\n    setProgressText(str: string) {\r\n        this.label_progress.string = str\r\n    }\r\n    setLogo(_sprite: SpriteFrame) {\r\n        let getUI = this.sprite_Logo.getComponent(UIOpacity)\r\n        getUI.opacity = 255\r\n        this.sprite_Logo.spriteFrame = _sprite\r\n        let getOrg = this.sprite_Logo.node.position\r\n        // tween(getUI)\r\n        //     .to(.5, { opacity: 255 })\r\n        //     .start()\r\n\r\n        // let action = tween()\r\n        //     .to(1, { position: v3(getOrg.x, getOrg.y + 30, getOrg.z) })\r\n        //     .to(1, { position: v3(getOrg.x, getOrg.y - 30, getOrg.z) })\r\n\r\n        // tween(this.sprite_Logo.node)\r\n        //     .set({ position: v3(getOrg.x, getOrg.y - 30, getOrg.z) })\r\n        //     .then(action)\r\n        //     .union()\r\n        //     .repeatForever()\r\n        //     .start()\r\n    }\r\n\r\n    closeGameLoadAction() {\r\n        /**停止Loading */\r\n        /**顯示登入介面 */\r\n\r\n    }\r\n    eventVerificationClient() {\r\n        /**送出驗證 */\r\n        const url = \"https://a1-gpg.ceis.tw/Token/ValidateContactInfo\"\r\n        const request = new RequestGPG.Request()\r\n        request.method = RequestGPG.Method.POST\r\n        const body = new RequestGPG.Body.ValidateContactInfo()\r\n        body.Phone = `+886999999999`\r\n        request.body = JSON.stringify(body)\r\n        fetch(url, request)\r\n            .then(this.我轉資料)\r\n            .then(this.我拿資料囉)\r\n\r\n        console.log(\"你會等我?\");\r\n    }\r\n    eventProgress(completedCount: number, totaleCount: number, item: any) {\r\n        // console.log(completedCount, totaleCount);\r\n\r\n        // console.log(MyMath.divide(completedCount, totaleCount));\r\n        // console.log(this.progressBar);\r\n\r\n        this.progressBar.progress = MyMath.divide(completedCount, totaleCount)\r\n\r\n        this.label_progress.string = Math.floor(MyMath.divide(completedCount, totaleCount) * 100).toString() + \"%\"\r\n\r\n        if (this.progressBar.progress >= 1) {\r\n            this.label_progress.string = \"wait other data\"\r\n        }\r\n\r\n    }\r\n    我轉資料(response) {\r\n        return response.json()\r\n    }\r\n    我拿資料囉(response) {\r\n        console.log(\"哈哈哈宋拉\", response)\r\n    }\r\n}"]}
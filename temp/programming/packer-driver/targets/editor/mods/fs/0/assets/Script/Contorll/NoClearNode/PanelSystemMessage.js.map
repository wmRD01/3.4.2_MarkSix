{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Contorll/NoClearNode/PanelSystemMessage.ts"],"names":["Button","find","Label","UITransform","v3","_decorator","BaseSingletonComponent","MyMath","GameEvent","LangType","WebSocketEvent","ButtonMng","SocketSetting","ccclass","property","PanelSystemMessage","onLoad","nodeFrame","node","countPosition","buttonConfirm","getComponent","labelConfirm","buttonCancel","labelCancel","labelCaption","hide","setEvent","SetLanguage","setLanguage","update","active","position","getScale","multiply","scale","x","string","t","Game","showSingleConfirm","caption","_callBack","arg","messageInit","setPosition","confirmCallback","clearEvent","addEvent","showSingleCancel","confirm","target","callback","callbackValue","showDoubleButton","twoBtnPositionX","closeWindow","eventEmit","CloseWindow","setCaption","show","spacing","divide","width","half"],"mappings":"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","sourcesContent":["import { Button, find, Label, Node, UITransform, v3, _decorator } from \"cc\";\r\nimport BaseSingletonComponent from \"../../../Patten/Singleton/BaseSingletonComponent\";\r\nimport MyMath from \"../../../Plug/MyMath\";\r\nimport { GameEvent } from \"../../Enum/GameEvent\";\r\nimport { LangType } from \"../../Enum/LangType\";\r\nimport { WebSocketEvent } from \"../../Enum/WebSocketEvent\";\r\nimport ButtonMng from \"../../Manager/ButtonMng\";\r\nimport SocketSetting from \"../../Socket/SocketSetting\";\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('PanelSystemMessage')\r\nexport default class PanelSystemMessage extends BaseSingletonComponent<PanelSystemMessage>() {\r\n    nodeFrame: Node\r\n    labelCaption: Label;\r\n    buttonConfirm: Button;\r\n    labelConfirm: Label;\r\n    buttonCancel: Button;\r\n    labelCancel: Label;\r\n    twoBtnPositionX: number\r\n    confirmCallback: Function;\r\n    onLoad() {\r\n        super.onLoad()\r\n        this.nodeFrame = find(\"Frame\", this.node)\r\n        this.countPosition()\r\n        this.buttonConfirm = find(\"ButtonConfirm\", this.nodeFrame).getComponent(Button)\r\n        this.labelConfirm = find(\"LabelConfirm\", this.nodeFrame).getComponent(Label)\r\n        this.buttonCancel = find(\"ButtonCancel\", this.nodeFrame).getComponent(Button)\r\n        this.labelCancel = find(\"LabelCancel\", this.nodeFrame).getComponent(Label)\r\n        this.labelCaption = find(\"LabelCaption\", this.nodeFrame).getComponent(Label)\r\n        this.hide()\r\n        this.setEvent(GameEvent.SetLanguage, this.setLanguage)\r\n\r\n    }\r\n    update() {\r\n        if (this.buttonConfirm.node.active) {\r\n            this.labelConfirm.node.position = this.buttonConfirm.node.position;\r\n            let getScale = MyMath.multiply(this.buttonConfirm.node.scale.x, 0.5)\r\n            this.labelConfirm.node.scale = v3(getScale, getScale, getScale);\r\n        }\r\n        if (this.buttonCancel.node.active) {\r\n            this.labelCancel.node.position = this.buttonCancel.node.position;\r\n            let getScale = MyMath.multiply(this.buttonCancel.node.scale.x, 0.5)\r\n            this.labelCancel.node.scale = v3(getScale, getScale, getScale);\r\n        }\r\n    }\r\n    setLanguage() {\r\n        this.labelConfirm.string = SocketSetting.t(\"1000\", LangType.Game)\r\n        this.labelCancel.string = SocketSetting.t(\"1001\", LangType.Game)\r\n        super.setLanguage()\r\n    }\r\n    showSingleConfirm(caption: string, _callBack?: Function, ...arg: any) {\r\n        this.messageInit(caption)\r\n\r\n        this.buttonConfirm.node.setPosition(0, -128);\r\n        this.confirmCallback = _callBack\r\n        ButtonMng.clearEvent(this.buttonConfirm);\r\n        if (_callBack)\r\n            ButtonMng.addEvent(this, \"onCallBack\", this.buttonConfirm);\r\n        ButtonMng.addEvent(this, \"addClickEffect\", this.buttonConfirm, \"btn_enter\");\r\n        ButtonMng.addEvent(this, \"hide\", this.buttonConfirm);\r\n        if (!this.buttonConfirm.node.active) {\r\n            this.buttonConfirm.node.active = true;\r\n            this.labelConfirm.node.active = true;\r\n        }\r\n    }\r\n\r\n    showSingleCancel(confirm?: ButtonFunctionApi) {\r\n        //取消按鈕\r\n        this.buttonCancel.node.setPosition(0, -128);\r\n        if (confirm)\r\n            ButtonMng.addEvent(confirm.target, confirm.callback, this.buttonConfirm, confirm.callbackValue ? confirm.callbackValue : null);\r\n        else {\r\n            ButtonMng.clearEvent(this.buttonCancel);\r\n            ButtonMng.addEvent(this, \"closeMessage\", this.buttonCancel);\r\n        }\r\n        if (!this.buttonCancel.node.active) {\r\n            this.buttonCancel.node.active = true;\r\n            this.labelCancel.node.active = true;\r\n        }\r\n    }\r\n    showDoubleButton(confirm: ButtonFunctionApi) {\r\n        // 確定按鈕\r\n        this.buttonConfirm.node.setPosition(this.twoBtnPositionX, -128);\r\n        ButtonMng.clearEvent(this.buttonConfirm);\r\n        ButtonMng.addEvent(confirm.target, confirm.callback, this.buttonConfirm, confirm.callbackValue ? confirm.callbackValue : null);\r\n        //取消按鈕\r\n        this.buttonCancel.node.setPosition(-this.twoBtnPositionX, -128);\r\n        ButtonMng.clearEvent(this.buttonCancel);\r\n        ButtonMng.addEvent(this, \"closeMessage\", this.buttonCancel);\r\n        if (!this.buttonCancel.node.active) {\r\n            this.buttonCancel.node.active = true;\r\n            this.labelCancel.node.active = true;\r\n        }\r\n        if (!this.buttonConfirm.node.active) {\r\n            this.buttonConfirm.node.active = true;\r\n            this.labelConfirm.node.active = true;\r\n        }\r\n    }\r\n\r\n    closeWindow() {\r\n        this.eventEmit(WebSocketEvent.CloseWindow)\r\n    }\r\n    setCaption(caption: string) {\r\n        this.labelCaption.string = caption\r\n    }\r\n    messageInit(caption: string) {\r\n        this.buttonCancel.node.active = false;\r\n        this.labelCancel.node.active = false;\r\n        this.buttonConfirm.node.active = false;\r\n        this.labelConfirm.node.active = false;\r\n        this.setCaption(caption)\r\n        this.show()\r\n    }\r\n\r\n\r\n    countPosition() {\r\n        //計算間距\r\n        let spacing = MyMath.divide(find(\"SpriteBG\", this.nodeFrame).getComponent(UITransform).width, 2 + 1) //需要+1原因是要計算一個範圍內的平均值，去切割的話要+1才可得出\r\n        //計算圖片的一半\r\n        let half = MyMath.divide(find(\"SpriteBG\", this.nodeFrame).getComponent(UITransform).width, 2)\r\n        this.twoBtnPositionX = half - spacing\r\n        // console.log(this.twoBtnPositionX, spacing, half);\r\n    }\r\n}"]}
{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Model/PointItemData.ts"],"names":["instantiate","Label","Node","Prefab","Size","UITransform","_decorator","BallData","BaseComponent","AutoFollow","PublicModel","ccclass","property","PointItemData","onLoad","clientPointLayout","removeAllChildren","openDrawCodeLayout","ui","node","getComponent","itemSize","UIbg","contentSize","width","height","itemState","setLabelContent","_node","labelContent","setOutlineContent","outlineContent","setDayData","day","issueID","labelDayData","string","getInstance","convertDateDay","toString","addComponent","createNewTarget","addChild","setOpenNumber","numbers","drawCode","index","length","maxNumberCount","specialBallItem","prefabBallItem","setScale","oneSclaeVec3","_class","init","Number","label","setSelfNumber","children","indexOf","setEffect","changeEffectColor","setScore","num","labelPoint","labelOpenNumberTitle","labelMyChooeseNumber","bool","console","log","setContentSize","halfSize","active","randomBall","Math","floor","random"],"mappings":"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","sourcesContent":["import { instantiate, Label, log, Node, Prefab, Size, Sprite, UITransform, _decorator } from 'cc';\r\nimport BallData from './BallData';\r\nimport BaseComponent from './ComponentBase';\r\nimport AutoFollow from './AutoFollow';\r\nimport PublicModel from './PublicModel';\r\nconst { ccclass, property } = _decorator;\r\n//TODO 缺乏優化DrawCode\r\n@ccclass('PointItemData')\r\nexport default class PointItemData extends BaseComponent {\r\n    @property(UITransform)\r\n    ui: UITransform;\r\n    @property(UITransform)\r\n    UIbg: UITransform;\r\n    @property(Prefab)\r\n    prefabBallItem: Prefab;\r\n    @property(Label)\r\n    labelMyChooeseNumber: Label;\r\n    @property(Label)\r\n    labelOpenNumberTitle: Label;\r\n    @property(Label)\r\n    labelPoint: Label;\r\n    maxNumberCount: number = 6\r\n    @property(Label)\r\n    labelDayData: Label;\r\n    @property(Node)\r\n    openDrawCodeLayout: Node\r\n    @property(Node)\r\n    clientPointLayout: Node\r\n    @property(Node)\r\n    specialBallItem: Node\r\n    labelContent: Node\r\n    outlineContent: Node;\r\n\r\n    drawCode: string[] = [];\r\n\r\n    itemSize: Size;\r\n\r\n    onLoad() {\r\n        this.clientPointLayout.removeAllChildren();\r\n        this.openDrawCodeLayout.removeAllChildren();\r\n        this.ui = this.node.getComponent(UITransform);\r\n        this.itemSize = new Size(this.UIbg.contentSize.width, this.UIbg.contentSize.height)\r\n        this.itemState(false)\r\n    }\r\n    setLabelContent(_node: Node) {\r\n        this.labelContent = _node\r\n        return this;\r\n    }\r\n    setOutlineContent(_node: Node) {\r\n        this.outlineContent = _node\r\n        return this;\r\n    }\r\n    /**\r\n     * \r\n     * @param day 日期 \r\n     * @param issueID 期號\r\n     */\r\n    setDayData(day: string, issueID: number) {\r\n        this.labelDayData.string = `${PublicModel.getInstance.convertDateDay(day)} 第${issueID.toString()}期`\r\n        this.labelDayData.addComponent(AutoFollow).createNewTarget()\r\n        this.labelContent.addChild(this.labelDayData.node)\r\n        return this\r\n    }\r\n    setOpenNumber(numbers: string[]) {\r\n        this.drawCode = numbers;\r\n        for (let index = 0; index < numbers.length; index++) {\r\n            let _node: Node;\r\n            if (index == this.maxNumberCount) _node = this.specialBallItem;\r\n            else {\r\n                _node = instantiate(this.prefabBallItem)\r\n                _node.setScale(PublicModel.getInstance.oneSclaeVec3(.6))\r\n                this.openDrawCodeLayout.addChild(_node)\r\n            }\r\n            let _class = _node.getComponent(BallData)\r\n            _class.init(Number(numbers[index]))\r\n            this.labelContent.addChild(_class.label.node)\r\n\r\n        }\r\n        return this\r\n    }\r\n    setSelfNumber(numbers: number[]) {\r\n        if (this.clientPointLayout.children.length >= this.maxNumberCount) return;\r\n        this.itemState(true)\r\n        for (let index = 0; index < numbers.length; index++) {\r\n            let _node = instantiate(this.prefabBallItem)\r\n            this.clientPointLayout.addChild(_node)\r\n            let _class = _node.getComponent(BallData)\r\n            _class.init(numbers[index])\r\n            this.labelContent.addChild(_class.label.node)\r\n            if (this.drawCode[index].indexOf(numbers[index].toString()) != -1) {\r\n                _class.setEffect(true);\r\n                _class.changeEffectColor();\r\n            }\r\n        }\r\n    }\r\n    setScore(num: number) {\r\n        this.labelPoint.string = `+${num.toString()}`;\r\n    }\r\n    init() {\r\n        this.labelOpenNumberTitle.addComponent(AutoFollow).createNewTarget()\r\n        this.labelContent.addChild(this.labelOpenNumberTitle.node)\r\n        this.labelMyChooeseNumber.addComponent(AutoFollow).createNewTarget()\r\n        this.outlineContent.addChild(this.labelMyChooeseNumber.node)\r\n        this.labelPoint.string = \"+0\"\r\n        this.labelPoint.addComponent(AutoFollow).createNewTarget()\r\n        this.labelContent.addChild(this.labelPoint.node)\r\n        return this\r\n    }\r\n\r\n    itemState(bool: boolean) {\r\n        if (bool) {\r\n            console.log(this.itemSize.height);\r\n\r\n            this.ui.setContentSize(this.itemSize)\r\n            this.UIbg.setContentSize(this.itemSize)\r\n        }\r\n        else {\r\n            let halfSize = new Size(this.itemSize.width, this.itemSize.height / 2)\r\n\r\n            this.ui.setContentSize(halfSize)\r\n            this.UIbg.setContentSize(halfSize)\r\n        }\r\n        this.clientPointLayout.active = bool;\r\n        this.labelMyChooeseNumber.node.active = bool;\r\n    }\r\n    /**測試用 */\r\n    randomBall() {\r\n        return 1 + (Math.floor(Math.random() * 49))\r\n    }\r\n}"]}
{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Model/PublicModel.ts"],"names":["PublicModel","director","dynamicAtlasManager","UITransform","Vec2","Vec3","BaseSingleton","MyMath","to2DConvertOtherNodeSpaceAR","targetNode","moveToNode","worldPoint","parent","getComponent","convertToWorldSpaceAR","position","convertToNodeSpaceAR","convertVec2ToVec3","vec2","x","y","convertVec3ToVec2","vec3","oneSclaeVec3","num","changParent","undefined","getScene","getChildByName","addChild","orgPos","formatSecond","secs","isMilli","min","Math","floor","toString","sec","Number","length","convertMilliToSecond","divide","checkNicknameCondition","str","rex","test","checkNameLen","name","len","word","split","filter","notWord","countLen","reName","count_name","index","count","cut_name","TwoClassCheckData","_self","_data","key","Object","prototype","hasOwnProperty","call","filterNumberDot","getStrArr","formatStr","_base64ToBytes","base64","binary_string","window","atob","bytes","Uint8Array","i","charCodeAt","convertByteToBinary","n","getBin","pokerNumberChange","baccaratCount","getLast","changeKMB","digits","suffixes","isNaN","String","exp","log","format","pow","decimalIndex","indexOf","slice","endsWith","getEnumValueFromString","enumObject","enumValues","keys","k","value","toLowerCase","getEnumValue","openShader","enabled"],"mappings":";;;6GAIqBA,W;;;;;;;;;;;;;;;;;AAJZC,MAAAA,Q,OAAAA,Q;AAAUC,MAAAA,mB,OAAAA,mB;AAA2BC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;AAC1DC,MAAAA,a;;AACAC,MAAAA,M;;;;;;;yBAEcP,W,GAAN,MAAMA,WAAN,SAA0B;AAAA;AAAA,2CAA1B,CAAuD;AAClE;AACJ;AACA;AACA;AACA;AACIQ,QAAAA,2BAA2B,CAACC,UAAD,EAAmBC,UAAnB,EAAqC;AAC5D;AACA;AACA,cAAIC,UAAU,GAAGD,UAAU,CAACE,MAAX,CAAkBC,YAAlB,CAA+BV,WAA/B,EAA4CW,qBAA5C,CAAkEJ,UAAU,CAACK,QAA7E,CAAjB,CAH4D,CAI5D;;AACA,iBAAON,UAAU,CAACG,MAAX,CAAkBC,YAAlB,CAA+BV,WAA/B,EAA4Ca,oBAA5C,CAAiEL,UAAjE,CAAP;AACH;;AACDM,QAAAA,iBAAiB,CAACC,IAAD,EAAa;AAC1B,iBAAO,IAAIb,IAAJ,CAASa,IAAI,CAACC,CAAd,EAAiBD,IAAI,CAACE,CAAtB,EAAyB,CAAzB,CAAP;AACH;;AACDC,QAAAA,iBAAiB,CAACC,IAAD,EAAa;AAC1B,iBAAO,IAAIlB,IAAJ,CAASkB,IAAI,CAACH,CAAd,EAAiBG,IAAI,CAACF,CAAtB,CAAP;AACH;;AACDG,QAAAA,YAAY,CAACC,GAAD,EAAc;AACtB,iBAAO,IAAInB,IAAJ,CAASmB,GAAT,EAAcA,GAAd,EAAmBA,GAAnB,CAAP;AACH;;AAGDC,QAAAA,WAAW,CAACf,UAAD,EAAmBD,UAAnB,EAAqCG,MAArC,EAAmD;AAC1D;AACA,cAAIF,UAAU,CAACE,MAAX,IAAqB,IAArB,IAA6BF,UAAU,CAACE,MAAX,IAAqBc,SAAtD,EACIzB,QAAQ,CAAC0B,QAAT,GAAoBC,cAApB,CAAmC,QAAnC,EAA6CC,QAA7C,CAAsDnB,UAAtD,EAHsD,CAI1D;;AAEA,cAAIoB,MAAM,GAAG,KAAKtB,2BAAL,CAAiCC,UAAjC,EAA6CC,UAA7C,CAAb;AACAE,UAAAA,MAAM,CAACiB,QAAP,CAAgBnB,UAAhB;AACAA,UAAAA,UAAU,CAACK,QAAX,GAAsBe,MAAtB;AACH;AACD;;;AACAC,QAAAA,YAAY,CAACC,IAAD,EAAeC,OAAf,EAAkC;AAC1C;AACA,cAAIC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWJ,IAAI,GAAG,EAAlB,EAAsBK,QAAtB,EAAV;AACA,cAAIC,GAAG,GAAGH,IAAI,CAACC,KAAL,CAAYJ,IAAI,GAAIO,MAAM,CAACL,GAAD,CAAN,GAAc,EAAlC,EAAwCG,QAAxC,EAAV;;AACA,iBAAOH,GAAG,CAACM,MAAJ,GAAa,CAApB,EAAuBN,GAAG,GAAG,MAAMA,GAAZ;;AACvB,iBAAOI,GAAG,CAACE,MAAJ,GAAa,CAApB,EAAuBF,GAAG,GAAG,MAAMA,GAAZ;;AACvB,iBAAOJ,GAAG,GAAG,GAAN,GAAYI,GAAnB;AACH;;AACDG,QAAAA,oBAAoB,CAACjB,GAAD,EAAc;AAC9B,iBAAO;AAAA;AAAA,gCAAOkB,MAAP,CAAclB,GAAd,EAAmB,IAAnB,CAAP;AACH;AACD;AACJ;AACA;;;AACImB,QAAAA,sBAAsB,CAACC,GAAD,EAAc;AAChC,cAAIC,GAAG,GAAG,wBAAV;AACA,iBAAOA,GAAG,CAACC,IAAJ,CAASF,GAAT,CAAP;AACH;AACD;;;AACAG,QAAAA,YAAY,CAACC,IAAD,EAAeC,GAAf,EAA4B;AACpC,cAAIC,IAAI,GAAGF,IAAI,CAACG,KAAL,CAAW,KAAX,EAAkBC,MAAlB,CAAyBjC,CAAC,IAAIA,CAAC,IAAI,EAAnC,CAAX;AACA,cAAIkC,OAAO,GAAGL,IAAI,CAACG,KAAL,CAAW,KAAX,EAAkBC,MAAlB,CAAyBjC,CAAC,IAAIA,CAAC,IAAI,EAAnC,CAAd;AACA,cAAImC,QAAQ,GAAGJ,IAAI,CAACV,MAAL,GAAeL,IAAI,CAACC,KAAL,CAAWiB,OAAO,CAACb,MAAR,GAAiB,CAA5B,CAA9B,CAHoC,CAGyB;;AAC7D,cAAIc,QAAQ,GAAGL,GAAf,EACID,IAAI,GAAG,KAAKO,MAAL,CAAYP,IAAZ,EAAkBC,GAAlB,CAAP;AACJ,iBAAOD,IAAP;AACH;AACD;;;AACQO,QAAAA,MAAM,CAACP,IAAD,EAAeC,GAAf,EAA4B;AACtC,cAAIO,UAAU,GAAG,EAAjB;AACA,cAAIC,KAAK,GAAG,CAAZ;AACA,cAAIC,KAAK,GAAG,CAAZ;AACA,cAAIC,QAAQ,GAAGX,IAAI,CAACG,KAAL,CAAW,EAAX,CAAf;;AACA,iBAAOO,KAAK,GAAGT,GAAf,EAAoB;AAChBO,YAAAA,UAAU,GAAGA,UAAU,GAAGG,QAAQ,CAACF,KAAD,CAAlC;AACA,gBAAI,KAAKX,IAAL,CAAUa,QAAQ,CAACF,KAAD,CAAlB,CAAJ,EAAgC;AAC5BC,cAAAA,KAAK,IAAI,GAAT,CADJ,KAGIA,KAAK;AACTD,YAAAA,KAAK;AACR;;AACDT,UAAAA,IAAI,GAAGQ,UAAU,GAAG,KAApB;AACA,iBAAOR,IAAP;AACH;AACD;AACJ;AACA;AACA;;;AACIY,QAAAA,iBAAiB,CAACC,KAAD,EAAgBC,KAAhB,EAA+B;AAC5C;AACA;AAEA,eAAK,MAAMC,GAAX,IAAkBD,KAAlB,EAAyB;AACrB,gBAAIE,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCN,KAArC,EAA4CE,GAA5C,CAAJ,EAAsD;AAClDF,cAAAA,KAAK,CAACE,GAAD,CAAL,GAAaD,KAAK,CAACC,GAAD,CAAlB;AACH;AACJ;AACJ;AACD;;;AACAK,QAAAA,eAAe,CAAC5C,GAAD,EAAuB;AAClC,cAAI6C,SAAS,GAAG7C,GAAG,CAACa,QAAJ,GAAec,KAAf,CAAqB,EAArB,EAAyBC,MAAzB,CAAgCjC,CAAC,IAAIA,CAAC,IAAI,GAA1C,CAAhB;AACA,cAAImD,SAAS,GAAG,EAAhB;;AACA,eAAK,IAAIb,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGY,SAAS,CAAC7B,MAAtC,EAA8CiB,KAAK,EAAnD,EAAuD;AACnD,gBAAI,WAAWX,IAAX,CAAgBuB,SAAS,CAACZ,KAAD,CAAzB,CAAJ,EACIa,SAAS,IAAID,SAAS,CAACZ,KAAD,CAAtB;AACP;;AACD,iBAAOa,SAAP;AACH;AACD;;;AACAC,QAAAA,cAAc,CAACC,MAAD,EAAiB;AAC3B,cAAIC,aAAa,GAAGC,MAAM,CAACC,IAAP,CAAYH,MAAZ,CAApB;AACA,cAAIvB,GAAG,GAAGwB,aAAa,CAACjC,MAAxB;AACA,cAAIoC,KAAK,GAAG,IAAIC,UAAJ,CAAe5B,GAAf,CAAZ;;AACA,eAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG7B,GAApB,EAAyB6B,CAAC,EAA1B,EAA8B;AAC1BF,YAAAA,KAAK,CAACE,CAAD,CAAL,GAAWL,aAAa,CAACM,UAAd,CAAyBD,CAAzB,CAAX;AACH;;AAED,iBAAOF,KAAP;AACH;AACD;;;AACAI,QAAAA,mBAAmB,CAACC,CAAD,EAAY;AAC3B,cAAIC,MAAM,GAAGD,CAAC,CAAC5C,QAAF,CAAW,CAAX,CAAb,CAD2B,CAE3B;AACA;;AACA,iBAAO6C,MAAP;AACH;AACD;;;AACAC,QAAAA,iBAAiB,CAAC3D,GAAD,EAAc;AAC3B,iBAAOA,GAAG,GAAGA,GAAG,GAAG,EAAN,IAAY,CAAZ,GAAgB,EAAhB,GAAqBA,GAAG,GAAG,EAAxC;AAEH;AACD;;;AACA4D,QAAAA,aAAa,CAAC1B,KAAD,EAAgBlC,GAAhB,EAA6B;AACtCA,UAAAA,GAAG,GAAG,CAAN,GAAUkC,KAAK,IAAI,CAAnB,GAAuBA,KAAK,IAAIlC,GAAhC;AACA,cAAI6D,OAA0B,GAAG3B,KAAK,CAACrB,QAAN,GAAiBc,KAAjB,CAAuB,EAAvB,CAAjC;AACAkC,UAAAA,OAAO,GAAGA,OAAO,CAACA,OAAO,CAAC7C,MAAR,GAAiB,CAAlB,CAAjB;AAEA,iBAAOD,MAAM,CAAC8C,OAAD,CAAb;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;;;AACIC,QAAAA,SAAS,CAAC9D,GAAD,EAAc+D,MAAc,GAAG,CAA/B,EAA0C;AAC/C,gBAAMC,QAAQ,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,CAAjB;AACA,cAAI,CAAChE,GAAD,IAAQe,MAAM,CAACkD,KAAP,CAAajE,GAAb,CAAZ,EACI,OAAOkE,MAAM,CAAC,CAAD,CAAb;AACJ,cAAIlE,GAAG,GAAG,KAAV,EACI,OAAOA,GAAG,CAACa,QAAJ,EAAP;AACJ,gBAAMsD,GAAG,GAAGxD,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACyD,GAAL,CAASpE,GAAT,IAAgBW,IAAI,CAACyD,GAAL,CAAS,IAAT,CAA3B,CAAZ;AACA,cAAIC,MAAM,GAAG,CAACrE,GAAG,GAAGW,IAAI,CAAC2D,GAAL,CAAS,IAAT,EAAeH,GAAf,CAAP,EAA4BtD,QAA5B,EAAb;AACA,gBAAM0D,YAAY,GAAGF,MAAM,CAACG,OAAP,CAAe,GAAf,CAArB;AACA,cAAID,YAAY,KAAK,CAAC,CAAlB,IAAuBA,YAAY,GAAGR,MAAf,GAAwB,CAAxB,GAA4BM,MAAM,CAACrD,MAA9D,EACIqD,MAAM,GAAGA,MAAM,CAACI,KAAP,CAAa,CAAb,EAAgBF,YAAY,GAAGR,MAAf,GAAwB,CAAxC,CAAT;;AACJ,cAAIM,MAAM,CAACK,QAAP,CAAgB,GAAhB,CAAJ,EAA0B;AACtBL,YAAAA,MAAM,GAAGA,MAAM,CAACI,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAT;AACH,WAb8C,CAc/C;;;AACA,iBAAOJ,MAAM,GAAGL,QAAQ,CAACG,GAAG,GAAG,CAAP,CAAxB;AACH;AACD;;;AACAQ,QAAAA,sBAAsB,CAAIvD,GAAJ,EAAiBwD,UAAjB,EAAwD;AAC1E,gBAAMC,UAAU,GAAGrC,MAAM,CAACsC,IAAP,CAAYF,UAAZ,EAAwBhD,MAAxB,CAA+BmD,CAAC,IAAI,OAAOH,UAAU,CAACG,CAAD,CAAjB,KAAoC,QAAxE,CAAnB;;AACA,eAAK,MAAMC,KAAX,IAAoBH,UAApB,EAAgC;AAC5B,gBAAIG,KAAK,CAACC,WAAN,OAAwB7D,GAAG,CAAC6D,WAAJ,EAA5B,EAA+C;AAC3C,qBAAOL,UAAU,CAACI,KAAD,CAAjB;AACH;AACJ;;AACD,iBAAO9E,SAAP;AACH;AACD;;;AACAgF,QAAAA,YAAY,CAAI9D,GAAJ,EAAiBwD,UAAjB,EAAwD;AAChE,gBAAMC,UAAU,GAAGrC,MAAM,CAACsC,IAAP,CAAYF,UAAZ,CAAnB;;AACA,eAAK,MAAMI,KAAX,IAAoBH,UAApB,EAAgC;AAC5B,gBAAIG,KAAK,CAACC,WAAN,OAAwB7D,GAAG,CAAC6D,WAAJ,EAA5B,EAA+C;AAC3C,qBAAOL,UAAU,CAACI,KAAD,CAAjB;AACH;AACJ;;AACD,iBAAO9E,SAAP;AACH;;AACDiF,QAAAA,UAAU,GAAG;AACTzG,UAAAA,mBAAmB,CAAC0G,OAApB,GAA8B,KAA9B,CADS,CAC0B;AACtC;;AAnLiE,O","sourcesContent":["import { director, dynamicAtlasManager, Node, UITransform, Vec2, Vec3, _decorator } from \"cc\";\r\nimport BaseSingleton from \"../../Patten/Singleton/BaseSingleton\";\r\nimport MyMath from \"../../Plug/MyMath\";\r\n\r\nexport default class PublicModel extends BaseSingleton<PublicModel>() {\r\n    /**\r\n     * @param targetNode 需要移動的物件\r\n     * @param moveToNode 移動的目的地\r\n     * @returns \r\n     */\r\n    to2DConvertOtherNodeSpaceAR(targetNode: Node, moveToNode: Node) {\r\n        // console.log(pos);\r\n        //轉成世界座標\r\n        let worldPoint = moveToNode.parent.getComponent(UITransform).convertToWorldSpaceAR(moveToNode.position);\r\n        // console.log(worldPoint);\r\n        return targetNode.parent.getComponent(UITransform).convertToNodeSpaceAR(worldPoint);\r\n    }\r\n    convertVec2ToVec3(vec2: Vec2) {\r\n        return new Vec3(vec2.x, vec2.y, 0)\r\n    }\r\n    convertVec3ToVec2(vec3: Vec3) {\r\n        return new Vec2(vec3.x, vec3.y)\r\n    }\r\n    oneSclaeVec3(num: number) {\r\n        return new Vec3(num, num, num)\r\n    }\r\n\r\n\r\n    changParent(moveToNode: Node, targetNode: Node, parent: Node) {\r\n        // console.log(node.parent);\r\n        if (moveToNode.parent == null || moveToNode.parent == undefined)\r\n            director.getScene().getChildByName(\"Canvas\").addChild(moveToNode)\r\n        // console.log(node.parent);\r\n\r\n        let orgPos = this.to2DConvertOtherNodeSpaceAR(targetNode, moveToNode)\r\n        parent.addChild(moveToNode)\r\n        moveToNode.position = orgPos\r\n    }\r\n    /**秒數時間轉換 */\r\n    formatSecond(secs: number, isMilli?: boolean) {\r\n        // if (isMilli) secs = this.convertMilliToSecond(secs);\r\n        let min = Math.floor(secs / 60).toString()\r\n        let sec = Math.floor((secs - (Number(min) * 60))).toString()\r\n        while (min.length < 2) min = \"0\" + min\r\n        while (sec.length < 2) sec = \"0\" + sec\r\n        return min + \":\" + sec\r\n    }\r\n    convertMilliToSecond(num: number) {\r\n        return MyMath.divide(num, 1000)\r\n    }\r\n    /*\r\n    *確認匿名條件式\r\n    */\r\n    checkNicknameCondition(str: string) {\r\n        let rex = /[\\p{P}+\\u2100-\\u214F]/u\r\n        return rex.test(str)\r\n    }\r\n    /**確認名稱長度 */\r\n    checkNameLen(name: string, len: number) {\r\n        let word = name.split(/\\w*/).filter(x => x != \"\")\r\n        let notWord = name.split(/\\W*/).filter(x => x != \"\")\r\n        let countLen = word.length + (Math.floor(notWord.length / 2))//英文數字兩個字元=1個中文字長度\r\n        if (countLen > len)\r\n            name = this.reName(name, len);\r\n        return name\r\n    }\r\n    /** 將8位數之後的文字\"...\"化 */\r\n    private reName(name: string, len: number) {\r\n        let count_name = ''\r\n        let index = 0\r\n        let count = 0\r\n        let cut_name = name.split('');\r\n        while (count < len) {\r\n            count_name = count_name + cut_name[index]\r\n            if (/\\w/.test(cut_name[index])) //如果遇到英文 只+0.5\r\n                count += 0.5\r\n            else\r\n                count++\r\n            index++\r\n        }\r\n        name = count_name + \"...\"\r\n        return name\r\n    }\r\n    /**封包整合，自身封包如果與傳遞的封包有相同Key值，自身封包會更新制最新Value \r\n     * @param _self 需整合封包\r\n     * @param _data 傳遞封包\r\n     */\r\n    TwoClassCheckData(_self: Object, _data: Object) {\r\n        // console.log(_self);\r\n        // console.log(_data);\r\n\r\n        for (const key in _data) {\r\n            if (Object.prototype.hasOwnProperty.call(_self, key)) {\r\n                _self[key] = _data[key];\r\n            }\r\n        }\r\n    }\r\n    /**將,文字刪除 */\r\n    filterNumberDot(num: number | string) {\r\n        let getStrArr = num.toString().split(\"\").filter(x => x != \",\");\r\n        let formatStr = \"\"\r\n        for (let index = 0; index < getStrArr.length; index++) {\r\n            if (/^[0-9]*$/.test(getStrArr[index]))\r\n                formatStr += getStrArr[index]\r\n        }\r\n        return formatStr\r\n    }\r\n    /**將Server傳遞封包轉換成Byte */\r\n    _base64ToBytes(base64: string) {\r\n        var binary_string = window.atob(base64);\r\n        var len = binary_string.length;\r\n        var bytes = new Uint8Array(len);\r\n        for (var i = 0; i < len; i++) {\r\n            bytes[i] = binary_string.charCodeAt(i);\r\n        }\r\n\r\n        return bytes;\r\n    }\r\n    /**將Byte轉換成Binary */\r\n    convertByteToBinary(n: number) {\r\n        let getBin = n.toString(2)\r\n        // do getBin = \"0\" + getBin\r\n        // while (getBin.length < 8)\r\n        return getBin\r\n    }\r\n    /**從52號碼變換成撲克13 */\r\n    pokerNumberChange(num: number) {\r\n        return num = num % 13 == 0 ? 13 : num % 13\r\n\r\n    }\r\n    /**百家規則9之後就是0，因此不會計算*/\r\n    baccaratCount(count: number, num: number) {\r\n        num > 9 ? count += 0 : count += num\r\n        let getLast: string | string[] = count.toString().split(\"\")\r\n        getLast = getLast[getLast.length - 1]\r\n\r\n        return Number(getLast)\r\n    }\r\n    /**\r\n     * \r\n     * @param num 數字\r\n     * @param digits 小數點位數 預設0\r\n     * @returns string\r\n     */\r\n    changeKMB(num: number, digits: number = 0): string {\r\n        const suffixes = ['K', 'M', 'B', 'T', 'P', 'E'];\r\n        if (!num || Number.isNaN(num))\r\n            return String(0);\r\n        if (num < 10000)\r\n            return num.toString();\r\n        const exp = Math.floor(Math.log(num) / Math.log(1000));\r\n        let format = (num / Math.pow(1000, exp)).toString();\r\n        const decimalIndex = format.indexOf('.');\r\n        if (decimalIndex !== -1 && decimalIndex + digits + 1 < format.length)\r\n            format = format.slice(0, decimalIndex + digits + 1);\r\n        if (format.endsWith('.')) {\r\n            format = format.slice(0, -1);\r\n        }\r\n        // console.warn(format + suffixes[exp - 1]);\r\n        return format + suffixes[exp - 1]\r\n    }\r\n    /**只能回傳num */\r\n    getEnumValueFromString<T>(str: string, enumObject: T): T[keyof T] | undefined {\r\n        const enumValues = Object.keys(enumObject).filter(k => typeof enumObject[k as keyof T] === 'number');\r\n        for (const value of enumValues) {\r\n            if (value.toLowerCase() === str.toLowerCase()) {\r\n                return enumObject[value as keyof T];\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    /*可回傳num與str(須測試) */\r\n    getEnumValue<T>(str: string, enumObject: T): T[keyof T] | undefined {\r\n        const enumValues = Object.keys(enumObject);\r\n        for (const value of enumValues) {\r\n            if (value.toLowerCase() === str.toLowerCase()) {\r\n                return enumObject[value as keyof T];\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    openShader() {\r\n        dynamicAtlasManager.enabled = false//打開Shader合批(????)\r\n    }\r\n}\r\n\r\n"]}
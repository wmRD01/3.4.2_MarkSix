{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Socket/GameWebSocket.ts"],"names":["Config","log","sys","_decorator","ln","URLVlaue","MessageCommend","LangType","CheckLoadingType","CommandType","WebSocketEvent","PublicData","SocketModel","SocketSetting","DelayTime","CheckLoading","GameData","Player","PublicModel","GameControll","CASTAPI","PlayerIdentity","WebPlatform","AssetMng","ccclass","property","GameWebSocket","onEnable","console","getInstance","checkLoading","checkState","isWebSocketOpen","node","destroy","judgePlatorm","Setting","MotifySetting","eventSetting","getWebPlatform","urlData","undefined","Default","dc","RomoteData","libPath","gameID","Date","getTime","connectToServer","bind","loadLanguageError","loadLogoAsset","UserLanguage","onDisable","closeWebsocket","test","from","data","push","start","jsonText","jsonTo","JSON","parse","TwoClassCheckData","host","connectionType","serverhost","serverport","startLoadLanguage","webSocket","WebSocket","onopen","onWS_Open","onerror","onWS_Error","onclose","onWS_Close","onmessage","onWS_Receive","setControllEvent","setEvent","Login","onLogIn","WebSocketSendCommand","onSend","BackHome","onBackHome","CloseWindow","onCloseWindow","ViewRecord","onViewRecord","StaoredValue","onStaoredValue","cmd","isClose","StartDT_NotClear","config","send","stringify","_ln","gameId","window","isGPGServer","_gameConfig","recordeURL","record","usertoken","token","lang","agentId","account","playerId","browser","browserType","browserVersion","os","osVersion","isMobile","key","roomNo","isFastInGame","identity","demo","Guest","Member","ident","coinType","recodeUrl","language","castAPI","connet","event","endWork","resetState","message","jmsg","serverRespond","e","formatRecordUrl","open","backHomeURL","document","location","href","staoredValueUrl","temp","close","usdis","search","length","getsearch","split","urldata","getsearchKey","searchList","datakey","url","callback","errCallback","platform","Platform","ANDROID","result","jsb","fileUtils","getStringFromFile","Error","xhr","XMLHttpRequest","errInfo","overrideMimeType","onload","readyState","status","response","ontimeout","androidLoadLanguage","getText","gameLang","loadLanguageEnd","serverLang","type","indexOf","Server","Game","setLang","init","err","loadLanguageCount","loadLanguageErrorAgain","messaggeState","t"],"mappings":"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","sourcesContent":["import { game, log, sys, _decorator } from \"cc\";\r\nimport { ln, URLVlaue } from \"../Contorll/Api/SendCommand\";\r\nimport { MessageCommend } from \"../Enum/MessageCommend\";\r\nimport { LangType } from \"../Enum/LangType\";\r\nimport { CheckLoadingType } from \"../Enum/CheckLoadingType\";\r\nimport { CommandType } from \"../Enum/CommandType\";\r\nimport { WebSocketEvent } from \"../Enum/WebSocketEvent\";\r\nimport PublicData from \"../Model/PublicData\";\r\nimport SocketModel from \"../Model/SocketModel\";\r\nimport SocketSetting from \"./SocketSetting\";\r\nimport DelayTime from '../../Plug/DelayTime';\r\nimport CheckLoading from \"../Model/CheckLoading\";\r\nimport GameData from \"../Model/GameData\";\r\nimport Player from \"../Model/Player\";\r\nimport PublicModel from \"../Model/PublicModel\";\r\nimport GameControll from \"../Contorll/GameControll/GameControll\";\r\nimport { CASTAPI } from \"../Contorll/Api/CASTAPI\";\r\nimport { PlayerIdentity } from \"../Enum/PlayerIdentity\";\r\nimport { WebPlatform } from \"../Enum/WebPlatform\";\r\nimport AssetMng from \"../Manager/AssetMng\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameWebSocket')\r\nexport default class GameWebSocket extends SocketModel {\r\n    onEnable(): void {\r\n        /**避免測試期間轉換到下一個場景的時候，又再次連線 */\r\n        console.log(PublicData.getInstance.checkLoading.checkState(CheckLoadingType.isWebSocketOpen));\r\n\r\n        if (PublicData.getInstance.checkLoading.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            this.node.destroy()\r\n            return\r\n        }\r\n        this.judgePlatorm();\r\n        this.Setting();\r\n        this.MotifySetting()\r\n        this.eventSetting();\r\n        let getWebPlatform = this.urlData == undefined ? WebPlatform.Default : (this.urlData as URLVlaue).dc\r\n        /**由於打包出去後似乎會被意外轉成Obj，因此還要再次判斷 */\r\n        getWebPlatform = typeof getWebPlatform !== 'string' ? WebPlatform.Default : getWebPlatform\r\n        // console.error(\"最終結果：\" + getWebPlatform);\r\n        //取得config拿取遊戲相關資料，其中包含連線的資訊\r\n        this.RomoteData(`${this.libPath}config/${GameData.getInstance.gameID}/${getWebPlatform}/game.json?${new Date().getTime()}`, this.connectToServer.bind(this), this.loadLanguageError.bind(this))\r\n        AssetMng.loadLogoAsset(this.UserLanguage)\r\n    }\r\n    onDisable() {\r\n        this.closeWebsocket()\r\n    }\r\n    test(from: Array<number>, data) {\r\n        from.push(data)\r\n    }\r\n    start() {\r\n        // let getWebPlatform = this.urlData == undefined ? WebPlatform.Default : (this.urlData as URLVlaue).dc\r\n        // /**由於打包出去後似乎會被意外轉成Obj，因此還要再次判斷 */\r\n        // getWebPlatform = typeof getWebPlatform !== 'string' ? WebPlatform.Default : getWebPlatform\r\n        // // console.error(\"最終結果：\" + getWebPlatform);\r\n        // //取得config拿取遊戲相關資料，其中包含連線的資訊\r\n        // this.RomoteData(`${this.libPath}config/${GameData.getInstance.gameID}/${getWebPlatform}/game.json?${new Date().getTime()}`, this.connectToServer.bind(this), this.loadLanguageError.bind(this))\r\n        // AssetMng.loadLogoAsset(this.UserLanguage)\r\n    }\r\n    connectToServer(jsonText: string) {\r\n        let jsonTo = JSON.parse(jsonText)\r\n        console.log(jsonTo);\r\n        PublicModel.getInstance.TwoClassCheckData(GameData.getInstance, jsonTo)\r\n        PublicModel.getInstance.TwoClassCheckData(this, jsonTo)\r\n        let host = `${this.connectionType}://${this.serverhost}:${this.serverport}`;\r\n        console.log(host);\r\n        this.startLoadLanguage()\r\n        this.webSocket = new WebSocket(host)\r\n        this.webSocket.onopen = this.onWS_Open.bind(this);\r\n        this.webSocket.onerror = this.onWS_Error.bind(this);\r\n        this.webSocket.onclose = this.onWS_Close.bind(this);\r\n        this.webSocket.onmessage = this.onWS_Receive.bind(this);\r\n    }\r\n\r\n    eventSetting() {\r\n        GameControll.getInstance.setControllEvent()\r\n        this.setEvent(WebSocketEvent.Login, this.onLogIn);\r\n        this.setEvent(WebSocketEvent.WebSocketSendCommand, this.onSend);\r\n        this.setEvent(WebSocketEvent.BackHome, this.onBackHome);\r\n        this.setEvent(WebSocketEvent.CloseWindow, this.onCloseWindow)\r\n        this.setEvent(WebSocketEvent.ViewRecord, this.onViewRecord)\r\n        this.setEvent(WebSocketEvent.StaoredValue, this.onStaoredValue)\r\n    }\r\n\r\n    async onSend(cmd, data) {\r\n        if (!CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            if (this.isClose) return\r\n\r\n            log(\"等待連線.......\")\r\n            await DelayTime.getInstance.StartDT_NotClear(0.5)\r\n            this.onSend(cmd, data)\r\n            return;\r\n        }\r\n        if (cmd == undefined || cmd == \"\") return;\r\n        let config = new Config();\r\n        config.cmd = cmd;\r\n        config.data = data || null;\r\n        console.log(' \\n=====送=====');\r\n        console.log(\">> cmd: \" + cmd);\r\n        console.log(\">> data: \", data);\r\n        console.log('=====送=====\\n ');\r\n        // console.log(JSON.stringify(config));\r\n        this.webSocket.send(JSON.stringify(config));\r\n    }\r\n\r\n\r\n\r\n    onLogIn(cmd) {\r\n        let _ln = new ln()\r\n        _ln.gameId = GameData.getInstance.gameID\r\n        if (window.isGPGServer && this.urlData != undefined) {\r\n            let _gameConfig = new URLVlaue()\r\n            PublicModel.getInstance.TwoClassCheckData(_gameConfig, this.urlData);\r\n            this.recordeURL = _gameConfig.record\r\n            this.usertoken = _gameConfig.token\r\n            this.UserLanguage = _gameConfig.lang\r\n            this.agentId = _gameConfig.agentId\r\n            this.account = _gameConfig.playerId\r\n            _gameConfig.browser = sys.browserType\r\n            _gameConfig.browserVersion = sys.browserVersion\r\n            _gameConfig.os = sys.os\r\n            _gameConfig.osVersion = sys.osVersion\r\n            _gameConfig.isMobile = sys.isMobile ? 1 : 0\r\n            _ln.key = JSON.stringify(_gameConfig)\r\n            GameData.getInstance.roomNo = _gameConfig.roomNo\r\n            GameData.getInstance.isFastInGame = _gameConfig.roomNo > 0 ? true : false\r\n            /**判斷是否為訪客帳號，如果收不到或者false就是正式會員 */\r\n            Player.getInstance.identity = _gameConfig.demo != undefined && _gameConfig.demo == \"true\" ? PlayerIdentity.Guest : PlayerIdentity.Member;\r\n        }\r\n        else if (window.isGPGServer)\r\n            _ln.key = JSON.stringify({})\r\n        _ln.account = this.account\r\n        _ln.ident = Player.getInstance.identity\r\n\r\n        GameData.getInstance.coinType = this.coinType;\r\n        PublicData.getInstance.recodeUrl = this.recordeURL;\r\n        PublicData.getInstance.language = this.UserLanguage\r\n        console.log(_ln, \"入房資訊\");\r\n        this.onSend(cmd, _ln)\r\n        /**與平台建立監聽溝通 */\r\n        PublicData.getInstance.castAPI = new CASTAPI()\r\n        PublicData.getInstance.castAPI.connet()\r\n    }\r\n\r\n\r\n    /////////////////////////////////////////////////////////////\r\n    ///     web socket event.\r\n    /////////////////////////////////////////////////////////////\r\n    //#region  \r\n    onWS_Open(event) {\r\n        console.log(\"Send Text WS was opened.\");\r\n        CheckLoading.getInstance.endWork(CheckLoadingType.isWebSocketOpen);\r\n        this.onLogIn(\"ln\")\r\n        if (this.usertoken == \"\") {\r\n            // GameControll.getInstance.messaggeState(MessageCommend.BackHome, SocketSetting.t(\"E_0001\", LangType.Game))\r\n            return;\r\n        }\r\n    }\r\n    onWS_Error(event) {\r\n        console.log(\"Send Text fired an error\");\r\n        CheckLoading.getInstance.resetState(CheckLoadingType.isWebSocketOpen);\r\n        // 連線錯誤，詳細情況請洽客服!\r\n        // GameControll.getInstance.messaggeState(MessageCommend.BackHome, SocketSetting.t(\"E_0001\", LangType.Game))\r\n    }\r\n    onWS_Close(event) {\r\n        console.log(\"WebSocket instance closed.\");\r\n        this.isClose = true\r\n        if (CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            CheckLoading.getInstance.resetState(CheckLoadingType.isWebSocketOpen);\r\n            // GameControll.getInstance.messaggeState(MessageCommend.BackHome, SocketSetting.t(\"E_0002\", LangType.Game))\r\n        };\r\n    }\r\n    onWS_Receive(event) {\r\n        let message = event.data;\r\n        try {\r\n            let jmsg = JSON.parse(message);\r\n            // console.log(jmsg);\r\n\r\n            if (typeof jmsg == \"object\") {\r\n                console.log(' \\n=====收=====');\r\n                console.log(\">> cmd: \" + jmsg.cmd);\r\n                console.log(jmsg.data);\r\n                console.log('=====收=====\\n ');\r\n                GameControll.getInstance.serverRespond(jmsg.cmd, jmsg.data);\r\n                return;\r\n            }\r\n        } catch (e) { }\r\n\r\n    }\r\n    //#endregion\r\n\r\n    onViewRecord() {\r\n        if (this.recordeURL != null && this.recordeURL != \"\" && this.recordeURL != \"undefined\") {\r\n            let formatRecordUrl = `${this.recordeURL}?agentId=${this.agentId}&playerId=${Player.getInstance.account}&lang=${this.UserLanguage}`\r\n            window.open(formatRecordUrl)\r\n        }\r\n    }\r\n    onBackHome() {\r\n        /**通知server斷線 */\r\n        // this.onSend(CommandType.usdis, {})\r\n        if (this.backHomeURL != null && this.backHomeURL != \"\" && this.backHomeURL != \"undefined\") {\r\n            document.location.href = this.backHomeURL;\r\n        }\r\n    }\r\n    onStaoredValue() {\r\n        if (this.staoredValueUrl != null && this.staoredValueUrl != \"\" && this.staoredValueUrl != \"undefined\") {\r\n            window.open(this.staoredValueUrl)\r\n        }\r\n    }\r\n    onCloseWindow() {\r\n        let temp = window.open('', '_self');\r\n        temp.close();\r\n    }\r\n    closeWebsocket() {\r\n        // this.isClose = true\r\n        // CheckLoading.getInstance.resetState(CheckLoadingType.isWebSocketOpen);\r\n        if (!PublicData.getInstance.checkLoading.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            return\r\n        }\r\n        this.onSend(CommandType.usdis, {})\r\n    }\r\n    /////////////////////////////////////////////////////////////\r\n    ///     lang載入設定.\r\n    /////////////////////////////////////////////////////////////\r\n\r\n    // server可自改語言與伺服器\r\n    MotifySetting() {\r\n        if ((window.location.search).length > 0) {\r\n            var getsearch: Array<string> = window.location.search.split('?');\r\n            var urldata: object = {};\r\n            for (var getsearchKey in getsearch) {\r\n                if (getsearch[getsearchKey] != \"\") {\r\n                    let searchList: Array<string> = getsearch[getsearchKey].split('&');\r\n                    for (var key in searchList) {\r\n                        urldata[searchList[key].split('=')[0]] = searchList[key].split('=')[1];\r\n                        /**這是要判斷是否強改資料的部分，改的話就不要套用DB給的資料 */\r\n                        for (var datakey in urldata) {\r\n                            if (datakey == \"L\" || datakey == \"l\") {\r\n                                this.UserLanguage = urldata[datakey];\r\n                                this.urlData = undefined\r\n                            }\r\n                            if (datakey == \"S\" || datakey == \"s\") {\r\n                                this.serverhost = urldata[datakey];\r\n                                this.urlData = undefined\r\n                            }\r\n                            if (datakey == \"P\" || datakey == \"p\") {\r\n                                this.serverport = urldata[datakey];\r\n                                this.urlData = undefined\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    RomoteData(url: string, callback: Function, errCallback: Function) {\r\n        var url = url;\r\n        console.log('downloadText.url:', url);\r\n        // console.log(url.startsWith(\"http://\"));\r\n        // console.log(sys.platform);\r\n        if (sys.platform === sys.Platform.ANDROID) {\r\n\r\n            var result = jsb.fileUtils.getStringFromFile(url);\r\n            if (typeof result === 'string' && result) {\r\n                return result;\r\n            }\r\n            else {\r\n                return new Error('Download text failed: ' + url);\r\n            }\r\n\r\n        } else {\r\n            if (callback) {\r\n                // console.log('downloadText getXMLHttpRequest')\r\n                var xhr = new XMLHttpRequest(),\r\n                    errInfo = 'Load text file failed: ' + url;\r\n                xhr.open('GET', url, true);\r\n                if (xhr.overrideMimeType) xhr.overrideMimeType('text\\/plain; charset=utf-8');\r\n                xhr.onload = function () {\r\n                    if (xhr.readyState === 4) {\r\n                        if (xhr.status === 200 || xhr.status === 0) {\r\n                            callback(xhr.response, url);\r\n                        }\r\n                        else {\r\n                            errCallback(url)\r\n                            // errCallback({ status: xhr.status, errorMessage: errInfo + '(wrong status)' });\r\n                        }\r\n                    }\r\n                    else {\r\n                        errCallback(url)\r\n                        // errCallback({ status: xhr.status, errorMessage: errInfo + '(wrong readyState)' });\r\n                    }\r\n                };\r\n                xhr.onerror = function () {\r\n                    errCallback(url)\r\n                    // errCallback({ status: xhr.status, errorMessage: errInfo + '(error)' });\r\n                };\r\n                xhr.ontimeout = function () {\r\n                    errCallback(url)\r\n                    // errCallback({ status: xhr.status, errorMessage: errInfo + '(time out)' });\r\n                };\r\n                xhr.send(null);\r\n            }\r\n        }\r\n    }\r\n    androidLoadLanguage(getText) {\r\n        let jsonTo = JSON.parse(getText)\r\n        // console.log(jsonTo);\r\n    }\r\n    startLoadLanguage() {\r\n        let gameLang = `${this.libPath}gameLanguage/${GameData.getInstance.gameID}/${this.UserLanguage}.json?/${new Date().getTime()}`\r\n        this.RomoteData(gameLang, this.loadLanguageEnd.bind(this), this.loadLanguageError.bind(this))\r\n        let serverLang = this.libPath + \"serverLanguage/\" + this.UserLanguage + \".json?\" + new Date().getTime()\r\n        this.RomoteData(serverLang, this.loadLanguageEnd.bind(this), this.loadLanguageError.bind(this))\r\n\r\n    }\r\n    loadLanguageEnd(jsonText: string, url?: string) {\r\n        console.log(\"loadLanguageEnd\");\r\n        let type = url.indexOf(\"gameLanguage\") == -1 ? LangType.Server : LangType.Game\r\n        let jsonTo = JSON.parse(jsonText)\r\n        SocketSetting.setLang(this.UserLanguage).init(jsonTo, type); //設定語言   \r\n        // SocketSetting.setLang(MyWebSocket.instence.UserLanguage).init(jsonTo, type); //設定語言   \r\n        // MainModelUp.instance.IsLoadLanguage = true;\r\n    }\r\n    loadLanguageError(url: string, err?: string) {\r\n        // console.log(\"loadLanguageError\");\r\n        if (err)\r\n            // console.log(\"錯誤?\" + err);\r\n\r\n            this.loadLanguageCount = 0;\r\n        this.RomoteData(url, this.loadLanguageEnd.bind(this), this.loadLanguageErrorAgain.bind(this));\r\n    }\r\n    loadLanguageErrorAgain(url: string) {\r\n        this.isClose = true\r\n        // console.log(\"语言包下载失败请通知客服\");\r\n        GameControll.getInstance.messaggeState(MessageCommend.BackHome, SocketSetting.t(\"S_0003\", LangType.Server))\r\n        // Panel_Message.showConfirm(this, 1, SocketSetting.t(\"S_9077\"), (e) => {\r\n        //     this.onBackHome();\r\n        // }); //\"语言包下载失败请通知客服\";\r\n        // MainModelUp.instance.ShowMessageBox = true;\r\n    }\r\n}\r\n\r\n\r\n\r\nclass Config {\r\n    cmd: string;\r\n    data: any;\r\n}\r\n\r\n// export default new MyWebSocket();\r\n\r\n\r\n// /**\r\n//  * 舊方法\r\n//  * \r\n//  */\r\n// loadScript(url, callback, callBackError) {\r\n//     console.log(url, callback, callBackError);\r\n\r\n//     var script = document.createElement(\"script\");\r\n//     console.log(script);\r\n\r\n//     script.type = \"text/javascript\";\r\n//     if (typeof (callback) != \"undefined\") {\r\n//         //@ts-ignore\r\n//         if (script.readyState) {\r\n//             //@ts-ignore\r\n//             script.onreadystatechange = function () {\r\n//                 //@ts-ignore\r\n//                 if (script.readyState == \"loaded\" || script.readyState == \"complete\") {\r\n//                     //@ts-ignore\r\n//                     script.onreadystatechange = null;\r\n//                     callback();\r\n//                 }\r\n//             };\r\n//         } else {\r\n//             script.onload = function () {\r\n//                 callback();\r\n//             };\r\n//             script.onerror = function (e) {\r\n//                 console.log(e);\r\n\r\n//                 if (MyWebSocket.instence.loadLanguageCount < 1) {\r\n//                     MyWebSocket.instence.loadScript(url, callback, callBackError);\r\n//                     MyWebSocket.instence.loadLanguageCount++;\r\n//                 } else {\r\n//                     callBackError();\r\n//                 }\r\n//             };\r\n//         }\r\n//     }\r\n//     script.src = url;\r\n//     document.body.appendChild(script);\r\n//     console.log(document.body);\r\n\r\n// }\r\n// /**\r\n//  * 舊方法\r\n//  * \r\n//  */\r\n// LoadLanguage(_language) {\r\n//     console.log(\"LoadLanguage\");\r\n\r\n//     // let LanguageURI = this.loadLanguage + this.UserLanguage + \".js?\" + new Date().getTime();\r\n//     let LanguageURI = this.loadLanguage + this.UserLanguage + \".js\";\r\n\r\n//     this.loadScript(LanguageURI, this.loadLanguageEnd, this.loadLanguageError);\r\n\r\n// }"]}
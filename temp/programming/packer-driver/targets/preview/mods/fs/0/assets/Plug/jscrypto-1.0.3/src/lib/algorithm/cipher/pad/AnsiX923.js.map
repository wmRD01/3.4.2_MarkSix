{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Plug/jscrypto-1.0.3/src/lib/algorithm/cipher/pad/AnsiX923.ts"],"names":["pad","data","blockSize","dataSigBytes","nSigBytes","blockSizeBytes","nPaddingBytes","lastBytePos","clamp","words","unpad","AnsiX923"],"mappings":";;;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAASA,GAAT,CAAaC,IAAb,EAAgCC,SAAhC,EAAkD;AAChD;AACA,QAAMC,YAAY,GAAGF,IAAI,CAACG,SAA1B;AACA,QAAMC,cAAc,GAAGH,SAAS,GAAG,CAAnC,CAHgD,CAKhD;;AACA,QAAMI,aAAa,GAAGD,cAAc,GAAGF,YAAY,GAAGE,cAAtD,CANgD,CAQhD;;AACA,QAAME,WAAW,GAAGJ,YAAY,GAAGG,aAAf,GAA+B,CAAnD,CATgD,CAWhD;;AACAL,IAAAA,IAAI,CAACO,KAAL;AACAP,IAAAA,IAAI,CAACQ,KAAL,CAAWF,WAAW,KAAK,CAA3B,KAAiCD,aAAa,IAAK,KAAMC,WAAW,GAAG,CAAf,GAAoB,CAA5E;AACAN,IAAAA,IAAI,CAACG,SAAL,IAAkBE,aAAlB;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAASI,KAAT,CAAeT,IAAf,EAAiC;AAC/B;AACA,QAAMK,aAAa,GAAGL,IAAI,CAACQ,KAAL,CAAYR,IAAI,CAACG,SAAL,GAAiB,CAAlB,KAAyB,CAApC,IAAyC,IAA/D,CAF+B,CAI/B;;AACAH,IAAAA,IAAI,CAACG,SAAL,IAAkBE,aAAlB;AACD;;;;;;;;;;;;;;;;;;;;;0BAEYK,Q,GAAgB;AAC3BX,QAAAA,GAD2B;AAE3BU,QAAAA;AAF2B,O","sourcesContent":["import type {Word32Array} from \"../../../Word32Array\";\nimport type {Pad} from \"./type\";\n\n/**\n * ANSI X.923 padding strategy\n *\n * @param {Word32Array} data The data to pad.\n * @param {number} blockSize The multiple that the data should be padded to.\n * @example\n *   AnsiX923.pad(wordArray, 4);\n */\nfunction pad(data: Word32Array, blockSize: number){\n  // Shortcuts\n  const dataSigBytes = data.nSigBytes;\n  const blockSizeBytes = blockSize * 4;\n  \n  // Count padding bytes\n  const nPaddingBytes = blockSizeBytes - dataSigBytes % blockSizeBytes;\n  \n  // Compute last byte position\n  const lastBytePos = dataSigBytes + nPaddingBytes - 1;\n  \n  // Pad\n  data.clamp();\n  data.words[lastBytePos >>> 2] |= nPaddingBytes << (24 - (lastBytePos % 4) * 8);\n  data.nSigBytes += nPaddingBytes;\n}\n\n/**\n * Unpads data that had been padded with ANSI X.923 padding strategy\n *\n * @param {Word32Array} data The data to unpad.\n * @example\n *   AnsiX923.unpad(wordArray);\n */\nfunction unpad(data: Word32Array){\n  // Get number of padding bytes from last byte\n  const nPaddingBytes = data.words[(data.nSigBytes - 1) >>> 2] & 0xff;\n  \n  // Remove padding\n  data.nSigBytes -= nPaddingBytes;\n}\n\nexport const AnsiX923: Pad = {\n  pad,\n  unpad,\n};\n"]}
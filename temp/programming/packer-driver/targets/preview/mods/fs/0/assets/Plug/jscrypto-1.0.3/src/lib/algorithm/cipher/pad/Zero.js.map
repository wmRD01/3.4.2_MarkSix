{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Plug/jscrypto-1.0.3/src/lib/algorithm/cipher/pad/Zero.ts"],"names":["pad","data","blockSize","blockSizeBytes","clamp","nSigBytes","unpad","dataWords","words","i","Zero"],"mappings":";;;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAASA,GAAT,CAAaC,IAAb,EAAgCC,SAAhC,EAAkD;AAChD;AACA,QAAMC,cAAc,GAAGD,SAAS,GAAG,CAAnC,CAFgD,CAIhD;;AACAD,IAAAA,IAAI,CAACG,KAAL;AACAH,IAAAA,IAAI,CAACI,SAAL,IAAkBF,cAAc,IAAKF,IAAI,CAACI,SAAL,GAAiBF,cAAlB,IAAqCA,cAAzC,CAAhC;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAASG,KAAT,CAAeL,IAAf,EAAiC;AAC/B;AACA,QAAMM,SAAS,GAAGN,IAAI,CAACO,KAAvB,CAF+B,CAI/B;;AACA,SAAK,IAAIC,CAAC,GAACR,IAAI,CAACI,SAAL,GAAe,CAA1B,EAA4BI,CAAC,IAAE,CAA/B,EAAiCA,CAAC,EAAlC,EAAqC;AACnC,UAAIF,SAAS,CAACE,CAAC,KAAK,CAAP,CAAT,KAAwB,KAAMA,CAAC,GAAG,CAAL,GAAU,CAAxC,GAA8C,IAAjD,EAAsD;AACpDR,QAAAA,IAAI,CAACI,SAAL,GAAiBI,CAAC,GAAC,CAAnB;AACA;AACD;AACF;AACF;;;;;;;;;;;;;;;;;;;;;sBAEYC,I,GAAY;AACvBV,QAAAA,GADuB;AAEvBM,QAAAA;AAFuB,O","sourcesContent":["import type {Word32Array} from \"../../../Word32Array\";\nimport type {Pad} from \"./type\";\n\n/**\n * Pads data with zero padding strategy.\n *\n * @param {Word32Array} data The data to pad.\n * @param {number} blockSize The multiple that the data should be padded to.\n * @example\n *   Zero.pad(wordArray, 4);\n */\nfunction pad(data: Word32Array, blockSize: number){\n  // Shortcut\n  const blockSizeBytes = blockSize * 4;\n  \n  // Pad\n  data.clamp();\n  data.nSigBytes += blockSizeBytes - ((data.nSigBytes % blockSizeBytes) || blockSizeBytes);\n}\n\n/**\n * Unpads data that had been padded with zero padding strategy.\n *\n * @param {Word32Array} data The data to unpad.\n * @example\n *   Zero.unpad(wordArray);\n */\nfunction unpad(data: Word32Array){\n  // Shortcut\n  const dataWords = data.words;\n  \n  // Unpad\n  for (let i=data.nSigBytes-1;i>=0;i--){\n    if((dataWords[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff){\n      data.nSigBytes = i+1;\n      break;\n    }\n  }\n}\n\nexport const Zero: Pad = {\n  pad,\n  unpad,\n};\n"]}
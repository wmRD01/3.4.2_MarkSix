{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Plug/jscrypto-1.0.3/test/specs/HmacSHA384.js"],"names":["expect","require","Hmac","SHA384","HmacSHA384","Hex","Word32Array","describe","it","expectedResult","message","key","parse","toString","to","be","hmac","update","finalize","expectedMessage","expectedKey","random","nSigBytes","keyClamped","clone","clamp"],"mappings":"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","sourcesContent":["const expect = require(\"expect.js\");\nconst {Hmac, SHA384, HmacSHA384, Hex, Word32Array} = require(\"../../test/build\");\n\ndescribe(\"hmac-sha384\", function(){\n  it(\"digest 'Hi There' as expected\", function(){\n    const expectedResult = \"7afaa633e20d379b02395915fbc385ff8dc27dcd3885e1068ab942eeab52ec1f20ad382a92370d8b2e0ac8b83c4d53bf\";\n    const message = \"Hi There\";\n    const key = Hex.parse(\"0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b\");\n    expect(HmacSHA384(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest 'what do ya want for nothing?' with 'Jefe' as expected\", function(){\n    const expectedResult = \"af45d2e376484031617f78d2b58a6b1b9c7ef464f5a01b47e42ec3736322445e8e2240ca5e69e2c78b3239ecfab21649\";\n    const message = \"what do ya want for nothing?\";\n    const key = \"Jefe\";\n    expect(HmacSHA384(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest long message and key as expected\", function(){\n    const expectedResult = \"1383e82e28286b91f4cc7afbd13d5b5c6f887c05e7c4542484043a37a5fe45802a9470fb663bd7b6570fe2f503fc92f5\";\n    const message = Hex.parse(\"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd\");\n    const key = Hex.parse(\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\");\n    expect(HmacSHA384(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' with 'A' as expected\", function(){\n    const expectedResult = \"365dfb271adb8e30fe6c74220b75df1b38c2d19b9d37f2e5a0ec2f3f22bd0406bf5b786e98d81b82c36d3d8a1be6cd07\";\n    const message = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    const key = \"A\";\n    expect(HmacSHA384(message, key).toString()).to.be(expectedResult);\n  });\n  it(\"digest 'abcdefghijklmnopqrstuvwxyz' with 'A' as expected\", function(){\n    const expectedResult = \"a8357d5e84da64140e41545562ae0782e2a58e39c6cd98939fad8d9080e774c84b7eaca4ba07f6dbf0f12eab912c5285\";\n    const message = \"abcdefghijklmnopqrstuvwxyz\";\n    const key = \"A\";\n    expect(HmacSHA384(message, key).toString()).to.be(expectedResult);\n  });\n  \n  it(\"update\", function(){\n    const hmac = new Hmac(new SHA384(), Hex.parse(\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"));\n    hmac.update(Hex.parse('dddddddddddddddddddddddddddddddddddd'));\n    hmac.update(Hex.parse('dddddddddddddddddddddddddddddddd'));\n    hmac.update(Hex.parse('dddddddddddddddddddddddddddddddd'));\n    \n    const message = Hex.parse(\"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd\");\n    const key = Hex.parse(\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\");\n    expect(HmacSHA384(message, key).toString()).to.be(hmac.finalize().toString());\n  });\n  \n  it(\"input integrity\", function(){\n    const message = new Word32Array([0x12345678]);\n    const key = new Word32Array([0x12345678]);\n    \n    const expectedMessage = message.toString();\n    const expectedKey = key.toString();\n    \n    HmacSHA384(message, key);\n    \n    expect(message.toString()).to.be(expectedMessage);\n    expect(key.toString()).to.be(expectedKey);\n  });\n  \n  it(\"respect key sigBytes\", function(){\n    const key = Word32Array.random(8);\n    key.nSigBytes = 4;\n    \n    const keyClamped = key.clone();\n    keyClamped.clamp();\n    \n    expect(HmacSHA384(\"Message\", key).toString()).to.be(HmacSHA384(\"Message\", keyClamped).toString());\n  });\n});\n"]}
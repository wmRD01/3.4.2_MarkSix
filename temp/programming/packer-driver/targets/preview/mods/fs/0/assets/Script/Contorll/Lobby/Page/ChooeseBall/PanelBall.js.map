{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Contorll/Lobby/Page/ChooeseBall/PanelBall.ts"],"names":["Timer","instantiate","Label","Layout","Node","Prefab","_decorator","DEV","DelayTime","AssetType","CheckLoadingType","CommandType","LangType","LobbyStateEvent","WebSocketEvent","AssetMng","ButtonMng","BallData","CheckLoading","BaseComponent","SocketSetting","bet","PanelLoading","PanelSystemMessage","ccclass","property","PanelBall","Map","start","waitStateCheck","Sprite","labelState","node","active","tipBox","remide","labelContent","removeAllChildren","HorLayout","isEnd","string","t","Game","replace","MaxCount","toString","V","Valign","layout","layoutItem","addChild","H","Halign","count","totalCount","_node","ballItem","_class","getComponent","mapBallNumber","set","init","cancel","setButtonAuto","setEffectAuto","setShadowAuto","addEvent","button","label","buttonContent","shadowContent","shoadow","effectContent","opacityEffect","getInstance","StartDT","index","children","length","enabled","forEach","element","getOrg","tipTimer","addComponent","eventEmit","ChangeBallButtonState","ChangeConfirmState","setEvent","UpDateBall","reProcessing","AttackBall","onConfirmAttack","NextIssueID","reset","onEnable","StartConnect","onDisable","CloseWebSocket","onTestReset","onRandomNumber","e","customEventData","onResetChooese","arr","random","Math","floor","indexOf","onChooeseBall","push","isConfirm","convert","Number","tempChoose","splice","get","isFullBall","fullResetBallColor","choose","setAction","ballNumber","enabledBall","isChoose","backPosition","Attack","instance","showSingleConfirm","len","shift","sort","a","b","BallChooeseAction","onSendCheckAttack","_bet","betCode","WebSocketSendCommand","bool","watiWebSocket","Promise","resolve","reject","checkState","isWebSocketOpen","inter","setInterval","clearInterval","data","console","log","closeLoading","labelIssueID","drawIssue","s","isAction","time","stopAction","update","dt"],"mappings":"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","sourcesContent":["import { Button, color, EventTouch, instantiate, Label, Layout, Node, Prefab, random, Sprite, Vec3, _decorator } from 'cc';\r\nimport { DEV } from 'cc/env';\r\nimport DelayTime from '../../../../../Plug/DelayTime';\r\nimport { AssetType } from '../../../../Enum/AssetType';\r\nimport { CheckLoadingType } from '../../../../Enum/CheckLoadingType';\r\nimport { CommandType } from '../../../../Enum/CommandType';\r\nimport { LangType } from '../../../../Enum/LangType';\r\nimport { LobbyStateEvent } from '../../../../Enum/LobbyStateEvent';\r\nimport { WebSocketEvent } from '../../../../Enum/WebSocketEvent';\r\nimport AssetMng from '../../../../Manager/AssetMng';\r\nimport ButtonMng from '../../../../Manager/ButtonMng';\r\nimport BallData from '../../../../Model/BallData';\r\nimport CheckLoading from '../../../../Model/CheckLoading';\r\nimport BaseComponent from '../../../../Model/ComponentBase';\r\nimport SocketSetting from '../../../../Socket/SocketSetting';\r\nimport * as RP from '../../../Api/ResponeCommand';\r\nimport { bet } from '../../../Api/SendCommand';\r\nimport PanelLoading from '../../../NoClearNode/PanelLoading';\r\nimport PanelSystemMessage from '../../../NoClearNode/PanelSystemMessage';\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('PanelBall')\r\nexport default class PanelBall extends BaseComponent {\r\n    @property(Node)\r\n    HorLayout: Node;\r\n    @property(Node)\r\n    labelContent: Node;\r\n    @property(Node)\r\n    buttonContent: Node;\r\n    @property(Node)\r\n    shadowContent: Node;\r\n    @property(Node)\r\n    effectContent: Node;\r\n    @property(Prefab)\r\n    layoutItem: Prefab;\r\n    @property(Prefab)\r\n    ballItem: Prefab;\r\n    @property(Label)\r\n    labelIssueID: Label\r\n    @property(Label)\r\n    labelState: Label\r\n    @property(Node)\r\n    tipBox: Node\r\n    @property(Node)\r\n    remide: Node\r\n\r\n\r\n\r\n    Halign: number = 10;\r\n    Valign: number = 5;\r\n    totalCount: number = 49\r\n    mapBallNumber: Map<number, BallData> = new Map()\r\n\r\n    isChoose: number[] = []\r\n    tempChoose: number[] = []\r\n    /**選擇球數最大值 */\r\n    MaxCount: number = 6\r\n    isConfirm: boolean;\r\n    isFullBall: boolean;\r\n    websocket: Node;\r\n\r\n    tipTimer: Timer\r\n\r\n\r\n    async start() {\r\n        await AssetMng.waitStateCheck(AssetType.Sprite)\r\n        this.labelState.node.active = true;\r\n        this.tipBox.active = false;\r\n        this.remide.active = false;\r\n        this.labelContent.removeAllChildren()\r\n        this.HorLayout.removeAllChildren()\r\n        let isEnd = false\r\n        this.labelState.string = SocketSetting.t(\"041\", LangType.Game).replace(\"$0\", this.MaxCount.toString())\r\n        for (let V = 0; V < this.Valign; V++) {\r\n            let layout = instantiate(this.layoutItem)\r\n            this.HorLayout.addChild(layout)\r\n            for (let H = 1; H <= this.Halign; H++) {\r\n                let count = (V * this.Halign) + H\r\n                if (count > this.totalCount) {\r\n                    isEnd = true\r\n                    break;\r\n                }\r\n                let _node = instantiate(this.ballItem)\r\n                let _class = _node.getComponent(BallData)\r\n                this.mapBallNumber.set(count, _class)\r\n                layout.addChild(_node)\r\n                _class.init(count)\r\n                    .cancel()\r\n                    .setButtonAuto()\r\n                    .setEffectAuto()\r\n                    .setShadowAuto();\r\n                ButtonMng.addEvent(this, \"onChooeseBall\", _class.button, count.toString())\r\n                this.labelContent.addChild(_class.label.node)\r\n                this.buttonContent.addChild(_class.button.node)\r\n                this.shadowContent.addChild(_class.shoadow.node)\r\n                this.effectContent.addChild(_class.opacityEffect.node)\r\n            }\r\n\r\n        }\r\n        await DelayTime.getInstance.StartDT(.016)\r\n        for (let index = 0; index < this.HorLayout.children.length; index++) {\r\n            //球往上飛所以不能讓他自動排版\r\n            this.HorLayout.children[index].getComponent(Layout).enabled = false\r\n\r\n        }\r\n        this.mapBallNumber.forEach(element => {\r\n            element.getOrg()\r\n        });\r\n        this.tipTimer = this.tipBox.addComponent(Timer)\r\n        this.eventEmit(LobbyStateEvent.ChangeBallButtonState, true)\r\n        this.eventEmit(LobbyStateEvent.ChangeConfirmState, false)\r\n        this.setEvent(LobbyStateEvent.UpDateBall, this.reProcessing)\r\n        this.setEvent(LobbyStateEvent.AttackBall, this.onConfirmAttack)\r\n        this.setEvent(LobbyStateEvent.NextIssueID, this.reset)\r\n    }\r\n    onEnable() {\r\n        this.eventEmit(LobbyStateEvent.ChangeConfirmState, false)\r\n        this.eventEmit(WebSocketEvent.StartConnect)\r\n\r\n    }\r\n    onDisable() {\r\n        this.eventEmit(WebSocketEvent.CloseWebSocket)\r\n    }\r\n    async reset() {\r\n        this.eventEmit(WebSocketEvent.CloseWebSocket)\r\n        this.onTestReset(null)\r\n        await DelayTime.getInstance.StartDT(.5);\r\n        this.eventEmit(WebSocketEvent.StartConnect)\r\n    }\r\n\r\n    onRandomNumber(e: EventTouch, customEventData?: string) {\r\n        this.onResetChooese(null)\r\n        let arr = []\r\n        while (arr.length < this.MaxCount) {\r\n            let random = 1 + Math.floor((Math.random() * (this.totalCount)))\r\n            if (arr.indexOf(random) == -1) {\r\n                this.onChooeseBall(null, random.toString())\r\n                arr.push(random)\r\n            }\r\n        }\r\n    }\r\n    onChooeseBall(e: EventTouch, customEventData?: string) {\r\n        if (this.isConfirm) return\r\n        let convert = Number(customEventData)\r\n        /**如果已經被選過的球 */\r\n        if (this.tempChoose.indexOf(convert) > -1) {\r\n            this.tempChoose.splice(this.tempChoose.indexOf(convert), 1)[0];\r\n            this.mapBallNumber.get(convert).cancel()\r\n            if (this.isFullBall) {\r\n\r\n                this.tipBox.active = false\r\n                this.fullResetBallColor(true)\r\n                this.eventEmit(LobbyStateEvent.ChangeConfirmState, false)\r\n            }\r\n            if (this.tempChoose.length == 0)\r\n                this.labelState.string = SocketSetting.t(\"041\", LangType.Game).replace(\"$0\", this.MaxCount.toString())\r\n            else\r\n                this.labelState.string = SocketSetting.t(\"042\", LangType.Game).replace(\"$0\", this.tempChoose.length.toString())\r\n            return\r\n        }\r\n        /**如果選號已滿 */\r\n        if (this.tempChoose.length >= this.MaxCount) return\r\n        /**紀錄球號 */\r\n        this.tempChoose.push(convert)\r\n        this.mapBallNumber.get(convert).choose()\r\n        this.labelState.string = SocketSetting.t(\"042\", LangType.Game).replace(\"$0\", this.tempChoose.length.toString())\r\n        if (this.tempChoose.length === this.MaxCount) {\r\n            this.isFullBall = true;\r\n            this.tipBox.active = true;\r\n            this.tipTimer.setAction(3)\r\n            this.eventEmit(LobbyStateEvent.ChangeConfirmState, true)\r\n            this.mapBallNumber.forEach(element => {\r\n                //代表沒被選種\r\n                if (this.tempChoose.indexOf(element.ballNumber) == -1) {\r\n                    element.enabledBall(false)\r\n                }\r\n            })\r\n        }\r\n\r\n    }\r\n    onTestReset(e: EventTouch, customEventData?: string) {\r\n        this.eventEmit(LobbyStateEvent.ChangeBallButtonState, true)\r\n        this.isChoose = []\r\n        this.tempChoose = []\r\n        /**選擇球數最大值 */\r\n        this.isConfirm = false\r\n        this.isFullBall = false\r\n        this.mapBallNumber.forEach(element => {\r\n            element.cancel()\r\n            element.backPosition()\r\n        })\r\n\r\n    }\r\n    onResetChooese(e: EventTouch, customEventData?: string) {\r\n        if (this.isConfirm) return\r\n        if (this.tempChoose.length === this.MaxCount) {\r\n            this.mapBallNumber.forEach(element => {\r\n                element.cancel()\r\n            })\r\n        }\r\n        else {\r\n            for (let index = 0; index < this.tempChoose.length; index++) {\r\n                this.mapBallNumber.get(this.tempChoose[index]).cancel()\r\n            }\r\n        }\r\n        this.tempChoose = []\r\n        this.eventEmit(LobbyStateEvent.ChangeConfirmState, false)\r\n        this.tipBox.active = false\r\n        this.labelState.string = SocketSetting.t(\"041\", LangType.Game).replace(\"$0\", this.MaxCount.toString())\r\n    }\r\n    async Attack() {\r\n        if (this.isConfirm) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"038\", LangType.Game))\r\n            return\r\n        }\r\n        if (this.tempChoose.length < this.MaxCount) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"039\", LangType.Game))\r\n            return\r\n        }\r\n        this.labelState.node.active = false;\r\n        this.tipBox.active = false\r\n        this.remide.active = true;\r\n        let len = this.tempChoose.length\r\n        for (let index = 0; index < len; index++) {\r\n            this.isChoose.push(this.tempChoose.shift())\r\n        }\r\n        this.isChoose.sort((a, b) => a - b)\r\n        /**沒辦法 得先關閉全部特效在座飛上去動作 */\r\n        for (let index = 0; index < this.isChoose.length; index++) {\r\n            this.mapBallNumber.get(this.isChoose[index]).cancel()\r\n        }\r\n\r\n        for (let index = 0; index < this.isChoose.length; index++) {\r\n            this.mapBallNumber.get(this.isChoose[index]).cancel()\r\n            this.eventEmit(LobbyStateEvent.BallChooeseAction, this.mapBallNumber.get(this.isChoose[index]).node, index)\r\n            await DelayTime.getInstance.StartDT(.1);\r\n        }\r\n\r\n\r\n        /**打leo的com */\r\n        this.tempChoose = []\r\n        this.isConfirm = true\r\n    }\r\n    onSendCheckAttack(e?: EventTouch, customEventData?: string) {\r\n        this.eventEmit(LobbyStateEvent.ChangeConfirmState, false)\r\n        const _bet = new bet()\r\n        _bet.betCode = this.tempChoose\r\n        this.eventEmit(WebSocketEvent.WebSocketSendCommand, CommandType.bet, _bet)\r\n\r\n    }\r\n    onConfirmAttack(e?: EventTouch, customEventData?: string) {\r\n        this.eventEmit(LobbyStateEvent.ChangeBallButtonState, false)\r\n        this.Attack()\r\n        PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"037\", LangType.Game))\r\n    }\r\n    fullResetBallColor(bool: boolean) {\r\n        this.mapBallNumber.forEach(element => {\r\n            element.enabledBall(bool)\r\n        })\r\n        this.isFullBall = !bool;\r\n    }\r\n    watiWebSocket() {\r\n        return new Promise<void>((resolve, reject) => {\r\n            if (CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n                resolve()\r\n                return\r\n            }\r\n            let inter = setInterval(() => {\r\n                if (CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n                    clearInterval(inter)\r\n                    resolve()\r\n                }\r\n            }, 100)\r\n        })\r\n    }\r\n\r\n    reProcessing(data: RP.ln | RP.bet) {\r\n        console.log(data);\r\n        this.onResetChooese(null)\r\n        if (data.betCode != null) {\r\n            if (this.isFullBall) {\r\n                if (DEV)\r\n                    this.onTestReset(null)\r\n                else {\r\n                    PanelLoading.instance.closeLoading()\r\n                    return\r\n                }\r\n            }\r\n            for (let index = 0; index < data.betCode.length; index++) {\r\n                this.onChooeseBall(null, data.betCode[index].toString())\r\n            }\r\n            this.Attack()\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"038\", LangType.Game))\r\n            this.eventEmit(LobbyStateEvent.ChangeBallButtonState, false)\r\n        }\r\n        this.labelIssueID.string = `第${data.drawIssue}期`;\r\n        PanelLoading.instance.closeLoading()\r\n    }\r\n\r\n}\r\nclass Timer extends BaseComponent {\r\n    isAction: boolean\r\n    time: number\r\n    setAction(s: number) {\r\n        this.isAction = true;\r\n        this.time = s\r\n        // console.error(\"原神起痛\");\r\n\r\n    }\r\n    stopAction() {\r\n        this.isAction = false\r\n    }\r\n    update(dt) {\r\n        if (this.isAction) {\r\n            this.time -= dt\r\n            if (this.time < 0) {\r\n                this.node.active = false;\r\n                this.stopAction()\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}
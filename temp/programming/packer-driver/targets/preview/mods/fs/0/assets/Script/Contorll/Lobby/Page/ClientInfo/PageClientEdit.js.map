{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Contorll/Lobby/Page/ClientInfo/PageClientEdit.ts"],"names":["Button","Label","Node","_decorator","NotificationType","LobbyStateEvent","EventMng","BaseComponent","Player","RequestGPG","MyEditBox","PublicModel","PanelLoading","ButtonMng","EditMenu","PanelSystemMessage","SocketSetting","LangType","VerificationTimer","PublicData","ccclass","property","PanelClientEdit","onLoad","getInstance","mapEvnet","get","PanelClient","on","EditNickname","onEditNickname","EditPhone","onEditPhone","EditEmail","onEditEmail","editNicName","string","editEmail","editPhone","reset","onDisable","spriteBG","node","active","textLabel","parent","btnsFunction","addEvent","buttonConfirm","motifyNickName","checkName","instance","openLoading","body","Body","NeedToken","Nickname","nickname","sign","convertSign","Request","setMethod","Method","POST","setBody","JSON","stringify","setToken","gpgToken","fetchData","gpgUrlPlayApi","API","responseNickname","bind","response","console","log","Status","Code","showSingleConfirm","t","Game","emit","EditUpdate","clearEvent","ServerAPI","closeLoading","onValidateContactInfoPhone","NotNeedToken","ValidateContactInfo","Phone","gpgUrlids","responseValidateContactInfo","onValidateContactInfoEmail","checkEmail","Email","sendBody","SendRegisterVerification","responseSendRegisterVerification","labelVerificationCode","buttonVerificationCode","activeVerificationCode","certifiedEmall","checkVerification","editVerificationCode","CertifiedEmail","email","verifyCode","CertifiedEmall","responseCertifiedEmall","bool","checkEmailRegular","_string","strEmail","emailRule","search","str","length","test","checkNicknameCondition"],"mappings":"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","sourcesContent":["import { Button, EventTouch, Label, Node, Sprite, SpriteFrame, _decorator } from 'cc';\r\nimport { NotificationType } from '../../../../Enum/NotificationType';\r\nimport { LobbyStateEvent } from '../../../../Enum/LobbyStateEvent';\r\nimport EventMng from '../../../../Manager/EventMng';\r\nimport BaseComponent from '../../../../Model/ComponentBase';\r\nimport Player from '../../../../Model/Player';\r\nimport { RequestGPG } from '../../../Api/GPGAPI/RequestGPG';\r\nimport { ResponseGPG } from '../../../Api/GPGAPI/ResponseGPG';\r\nimport { MyEditBox } from '../../../../../Plug/MyEditBox';\r\nimport PublicModel from '../../../../Model/PublicModel';\r\nimport PanelLoading from '../../../NoClearNode/PanelLoading';\r\nimport ButtonMng from '../../../../Manager/ButtonMng';\r\nimport { EditMenu } from '../../../../Enum/EditMenu';\r\nimport PanelSystemMessage from '../../../NoClearNode/PanelSystemMessage';\r\nimport SocketSetting from '../../../../Socket/SocketSetting';\r\nimport { LangType } from '../../../../Enum/LangType';\r\nimport { VerificationTimer } from '../../../../Model/VerificationTimer';\r\nimport PublicData from '../../../../Model/PublicData';\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('PanelClientEdit')\r\nexport default class PanelClientEdit extends BaseComponent {\r\n    @property(MyEditBox)\r\n    editNicName: MyEditBox;\r\n    @property(MyEditBox)\r\n    editPhone: MyEditBox;\r\n    @property(MyEditBox)\r\n    editEmail: MyEditBox;\r\n    @property(MyEditBox)\r\n    editVerificationCode: MyEditBox;\r\n\r\n    @property(Button)\r\n    buttonVerificationCode: Button\r\n\r\n    @property(Button)\r\n    buttonConfirm: Button\r\n\r\n    @property(Node)\r\n    btnsFunction: Node\r\n    @property(Label)\r\n    labelVerificationCode: Label;\r\n\r\n    onLoad() {\r\n        EventMng.getInstance.mapEvnet.get(NotificationType.PanelClient).on(LobbyStateEvent.EditNickname, this.onEditNickname, this)\r\n        EventMng.getInstance.mapEvnet.get(NotificationType.PanelClient).on(LobbyStateEvent.EditPhone, this.onEditPhone, this)\r\n        EventMng.getInstance.mapEvnet.get(NotificationType.PanelClient).on(LobbyStateEvent.EditEmail, this.onEditEmail, this)\r\n        this.editNicName.string = \"\"\r\n        this.editEmail.string = \"\"\r\n        this.editPhone.string = \"\"\r\n        this.reset()\r\n        super.onLoad()\r\n    }\r\n    onDisable() {\r\n        this.reset()\r\n    }\r\n    //#region  Nickname\r\n    /**送出修改NickName */\r\n    private onEditNickname() {\r\n        this.editNicName.spriteBG.node.active = true\r\n        this.editNicName.textLabel.node.parent.active = true;\r\n        this.btnsFunction.active = true\r\n        ButtonMng.addEvent(this, \"motifyNickName\", this.buttonConfirm)\r\n    }\r\n\r\n    async motifyNickName() {\r\n        if (!this.checkName(this.editNicName.string)) return;\r\n        PanelLoading.instance.openLoading(\"資料更新中\")\r\n        const body = new RequestGPG.Body.NeedToken.Nickname()\r\n        body.nickname = this.editNicName.string\r\n        body.sign = PublicModel.getInstance.convertSign(body, RequestGPG.Body.NeedToken.Nickname)\r\n        await new RequestGPG.Request()\r\n            .setMethod(RequestGPG.Method.POST)\r\n            .setBody(JSON.stringify(body))\r\n            .setToken(Player.getInstance.gpgToken)\r\n            .fetchData(`${PublicData.getInstance.gpgUrlPlayApi}${RequestGPG.API.Nickname}`, this.responseNickname.bind(this))\r\n    }\r\n    /**驗證碼發送是否成功 */\r\n    responseNickname(response: ResponseGPG.Nickname.DataClass) {\r\n        console.log(\"Nickname\", response)\r\n\r\n        if (response.Status.Code == \"0\") {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"026\", LangType.Game))\r\n            EventMng.getInstance.mapEvnet.get(NotificationType.PanelClient).emit(LobbyStateEvent.EditUpdate, this.editNicName.string, EditMenu.Nickname)\r\n            ButtonMng.clearEvent(this.buttonConfirm);\r\n            this.reset()\r\n        }\r\n        else {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(response.Status.Code, LangType.ServerAPI))\r\n            PanelLoading.instance.closeLoading()\r\n            // console.error(\"資料有問題\");\r\n        }\r\n    }\r\n    //#endregion\r\n    //#region ValidateContactInfo\r\n    /**進行發送驗證碼時，必須先通過確認手機是否被註冊過 */\r\n    async onValidateContactInfoPhone() {\r\n        /**確認信箱 */\r\n        //TODO 製作手機驗證(整理好後再回頭製作)\r\n        const body = new RequestGPG.Body.NotNeedToken.ValidateContactInfo()\r\n        body.Phone = this.editPhone.string;\r\n        await new RequestGPG.Request()\r\n            .setMethod(RequestGPG.Method.POST)\r\n            .setBody(JSON.stringify(body))\r\n            .fetchData(`${PublicData.getInstance.gpgUrlids}${RequestGPG.API.ValidateContactInfo}`, this.responseValidateContactInfo.bind(this))\r\n    }\r\n    async onValidateContactInfoEmail() {\r\n        /**確認信箱格式 */\r\n        if (!this.checkEmail(this.editEmail.string)) return;\r\n        const body = new RequestGPG.Body.NotNeedToken.ValidateContactInfo()\r\n        body.Email = this.editEmail.string;\r\n        await new RequestGPG.Request()\r\n            .setMethod(RequestGPG.Method.POST)\r\n            .setBody(JSON.stringify(body))\r\n            .fetchData(`${PublicData.getInstance.gpgUrlids}${RequestGPG.API.ValidateContactInfo}`, this.responseValidateContactInfo.bind(this))\r\n    }\r\n    async responseValidateContactInfo(response: ResponseGPG.ValidateContactInfo.DataClass) {\r\n        console.log(\"ValidateContactInfo\", response)\r\n        /**代表此已經綁定過不可以綁定! */\r\n        if (response.Status.Code == \"0\") {\r\n            if (this.editEmail.string != \"\")\r\n                PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"040\", LangType.Game))\r\n            if (this.editPhone.string != \"\")\r\n                PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"034\", LangType.Game))\r\n            return;\r\n        }\r\n        else {\r\n            console.log(\"恭喜信箱不存在，可繼續註冊\");\r\n            //*要改成手動送驗證碼\r\n            const sendBody = new RequestGPG.Body.NotNeedToken.SendRegisterVerification()\r\n            if (this.editEmail.string != \"\")\r\n                sendBody.Email = this.editEmail.string\r\n            if (this.editPhone.string != \"\")\r\n                sendBody.Phone = this.editPhone.string\r\n            await new RequestGPG.Request()\r\n                .setMethod(RequestGPG.Method.POST)\r\n                .setBody(JSON.stringify(sendBody))\r\n                .fetchData(`${PublicData.getInstance.gpgUrlids}${RequestGPG.API.SendRegisterVerification}`, this.responseSendRegisterVerification.bind(this))\r\n        }\r\n    }\r\n    /**驗證碼發送是否成功 */\r\n    responseSendRegisterVerification(response: ResponseGPG.SendRegisterVerification.DataClass) {\r\n        console.log(\"SendRegisterVerification\", response)\r\n        if (response.Status.Code == \"0\") {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"035\", LangType.Game))\r\n            new VerificationTimer(this.labelVerificationCode, this.buttonVerificationCode, 180)\r\n            console.log(\"送出驗證碼囉\");\r\n        }\r\n\r\n    }\r\n    //#endregion\r\n    //#region Phone\r\n    private onEditPhone() {\r\n        this.editPhone.spriteBG.node.active = true\r\n        this.editPhone.textLabel.node.parent.active = true;\r\n        this.activeVerificationCode(true)\r\n        this.btnsFunction.active = true\r\n        ButtonMng.addEvent(this, \"onValidateContactInfoPhone\", this.buttonVerificationCode)\r\n        ButtonMng.addEvent(this, \"創立修改手機的\", this.buttonConfirm)\r\n    }\r\n    //TODO 修改手機的方法\r\n    //#endregion\r\n    //#region Email\r\n\r\n    private onEditEmail() {\r\n        this.editEmail.spriteBG.node.active = true\r\n        this.editEmail.textLabel.node.parent.active = true;\r\n        this.activeVerificationCode(true)\r\n        this.btnsFunction.active = true\r\n        ButtonMng.addEvent(this, \"onValidateContactInfoEmail\", this.buttonVerificationCode)\r\n        ButtonMng.addEvent(this, \"certifiedEmall\", this.buttonConfirm)\r\n\r\n\r\n    }\r\n    /**送出前須確認驗證碼的正確性，但前題是他必須得先需要註冊信箱時才會接這個function */\r\n    async certifiedEmall() {\r\n        if (!this.checkEmail(this.editEmail.string)) return;\r\n        if (!this.checkVerification(this.editVerificationCode.string)) return;\r\n        /**確認信箱格式 */\r\n        const body = new RequestGPG.Body.NeedToken.CertifiedEmail()\r\n        body.email = this.editEmail.string\r\n        body.verifyCode = this.editVerificationCode.string\r\n        body.sign = PublicModel.getInstance.convertSign(body, RequestGPG.Body.NeedToken.CertifiedEmail)\r\n        await new RequestGPG.Request()\r\n            .setMethod(RequestGPG.Method.POST)\r\n            .setToken(Player.getInstance.gpgToken)\r\n            .setBody(JSON.stringify(body))\r\n            .fetchData(`${PublicData.getInstance.gpgUrlPlayApi}${RequestGPG.API.CertifiedEmall}`, this.responseCertifiedEmall.bind(this))\r\n    }\r\n\r\n    /**是否修改信箱成功 */\r\n    responseCertifiedEmall(response: ResponseGPG.CertifiedEmall.DataClass) {\r\n        console.log(\"CertifiedEmall\", response)\r\n        if (response.Status.Code == \"0\") {\r\n            console.log(\"過關惹\");\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"036\", LangType.ServerAPI))\r\n            EventMng.getInstance.mapEvnet.get(NotificationType.PanelClient).emit(LobbyStateEvent.EditUpdate, this.editEmail.string, EditMenu.Email)\r\n            ButtonMng.clearEvent(this.buttonConfirm);\r\n            this.reset()\r\n        }\r\n        else {\r\n            //TODO顯示錯誤訊息\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(response.Status.Code, LangType.ServerAPI))\r\n            PanelLoading.instance.closeLoading()\r\n        }\r\n    }\r\n    //#endregion\r\n    private activeVerificationCode(bool: boolean) {\r\n        this.editVerificationCode.spriteBG.node.active = bool\r\n        this.editVerificationCode.textLabel.node.parent.active = bool;\r\n        this.buttonVerificationCode.node.active = bool\r\n\r\n        // if (!bool)\r\n        // this.btnsFunction.position = PublicModel.getInstance.to2DConvertOtherNodeSpaceAR(this.btnsFunction, this.editEmail.spriteBG.node)\r\n    }\r\n    private reset() {\r\n        this.editNicName.spriteBG.node.active = false\r\n        this.editNicName.textLabel.node.parent.active = false;\r\n        this.editEmail.spriteBG.node.active = false\r\n        this.editEmail.textLabel.node.parent.active = false;\r\n        this.editPhone.spriteBG.node.active = false\r\n        this.editPhone.textLabel.node.parent.active = false;\r\n        this.activeVerificationCode(false)\r\n        this.btnsFunction.active = false;\r\n        this.buttonVerificationCode.node.active = false;\r\n        this.editEmail.string = \"\";\r\n        this.editNicName.string = \"\";\r\n        this.editNicName.string = \"\";\r\n        this.editVerificationCode.string = \"\";\r\n    }\r\n    /**確認信箱格式 */\r\n    checkEmailRegular(_string: string) {\r\n        //please input the test email to see is valid\r\n        var strEmail = _string;\r\n\r\n        //Regular expression Testing\r\n        var emailRule = /^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z]+$/;\r\n\r\n        //validate ok or not\r\n        if (strEmail.search(emailRule) != -1) {\r\n            return true\r\n        } else {\r\n            return false\r\n        }\r\n    }\r\n    checkName(str: string) {\r\n        if (str.length == 0 || (str.length < 2 || str.length > 16)) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"031\", LangType.Game))\r\n            // console.error(\"長度須為2~16\");\r\n            return false;\r\n        }\r\n        if (/\\s/.test(str)) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"029\", LangType.Game))\r\n            // console.error(\"文字有空白\");\r\n            return false;\r\n        }\r\n        if (PublicModel.getInstance.checkNicknameCondition(str)) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"030\", LangType.Game))\r\n            // console.error(\"出現非法文字\");\r\n            return false;\r\n        }\r\n\r\n        return true\r\n    }\r\n    /**\r\n     * \r\n     * @param str 信箱\r\n     */\r\n    checkEmail(str: string) {\r\n        if (str.length == 0) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"028\", LangType.Game))\r\n            // console.error(\"請輸入信箱\");\r\n            return false;\r\n        }\r\n        if (/\\s/.test(str)) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"029\", LangType.Game))\r\n            // console.error(\"文字有空白\");\r\n            return false;\r\n        }\r\n        if (!this.checkEmailRegular(str)) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"028\", LangType.Game))\r\n            // console.error(\"請輸入正確信箱\");\r\n            return false;\r\n        }\r\n        return true\r\n    }\r\n    /**\r\n     * @param verification 驗證碼  \r\n     */\r\n    checkVerification(str: string) {\r\n        if (str.length == 0) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"033\", LangType.Game))\r\n            // console.error(\"請輸入數字\");\r\n            return false;\r\n        }\r\n        if (/\\s/.test(str)) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"029\", LangType.Game))\r\n            // console.error(\"文字有空白\");\r\n            return false;\r\n        }\r\n        if (str.length != 6) {\r\n            PanelSystemMessage.instance.showSingleConfirm(SocketSetting.t(\"032\", LangType.Game))\r\n            // console.error(\"驗證碼最少六碼\");\r\n            return false;\r\n        }\r\n        return true\r\n    }\r\n\r\n}\r\n\r\n\r\n"]}
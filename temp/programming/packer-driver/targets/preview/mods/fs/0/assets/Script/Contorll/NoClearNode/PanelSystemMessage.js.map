{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Contorll/NoClearNode/PanelSystemMessage.ts"],"names":["Button","find","Label","UITransform","v3","_decorator","ButtonMng","MyMath","GameEvent","SocketSetting","LangType","WebSocketEvent","BaseSingletonComponent","ccclass","property","PanelSystemMessage","onLoad","nodeFrame","node","countPosition","buttonConfirm","getComponent","labelConfirm","buttonCancel","labelCancel","labelCaption","hide","onEnable","setEvent","SystemMessage","onSystemMessage","SetLanguage","setLanguage","update","active","position","getScale","multiply","scale","x","string","t","Game","showSingleConfirm","confirm","setPosition","addEvent","target","callback","callbackValue","clearEvent","showSingleCancel","showDoubleButton","twoBtnPositionX","caption","_buttonFunctionApi","messageInit","closeMessage","closeWindow","eventEmit","CloseWindow","setCaption","show","spacing","divide","width","half"],"mappings":"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","sourcesContent":["import { Button, Component, EditBox, find, game, Label, macro, Node, UITransform, v3, Vec3, _decorator } from \"cc\";\r\nimport ButtonMng from \"../../Manager/ButtonMng\";\r\nimport MyMath from \"../../../Plug/MyMath\";\r\nimport { GameEvent } from \"../../Enum/GameEvent\";\r\nimport SocketSetting from \"../../Socket/SocketSetting\";\r\nimport { LangType } from \"../../Enum/LangType\";\r\nimport { WebSocketEvent } from \"../../Enum/WebSocketEvent\";\r\nimport BaseSingletonComponent from \"../../../Patten/Singleton/BaseSingletonComponent\";\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('PanelSystemMessage')\r\nexport default class PanelSystemMessage extends BaseSingletonComponent<PanelSystemMessage>() {\r\n    nodeFrame: Node\r\n    labelCaption: Label;\r\n    buttonConfirm: Button;\r\n    labelConfirm: Label;\r\n    buttonCancel: Button;\r\n    labelCancel: Label;\r\n    twoBtnPositionX: number\r\n    onLoad() {\r\n        super.onLoad()\r\n        this.nodeFrame = find(\"Frame\", this.node)\r\n        this.countPosition()\r\n        this.buttonConfirm = find(\"ButtonConfirm\", this.nodeFrame).getComponent(Button)\r\n        this.labelConfirm = find(\"LabelConfirm\", this.nodeFrame).getComponent(Label)\r\n        this.buttonCancel = find(\"ButtonCancel\", this.nodeFrame).getComponent(Button)\r\n        this.labelCancel = find(\"LabelCancel\", this.nodeFrame).getComponent(Label)\r\n        this.labelCaption = find(\"LabelCaption\", this.nodeFrame).getComponent(Label)\r\n        this.hide()\r\n\r\n    }\r\n    onEnable() {\r\n        this.setEvent(GameEvent.SystemMessage, this.onSystemMessage)\r\n        this.setEvent(GameEvent.SetLanguage, this.setLanguage)\r\n    }\r\n    update() {\r\n        if (this.buttonConfirm.node.active) {\r\n            this.labelConfirm.node.position = this.buttonConfirm.node.position;\r\n            let getScale = MyMath.multiply(this.buttonConfirm.node.scale.x, 0.5)\r\n            this.labelConfirm.node.scale = v3(getScale, getScale, getScale);\r\n        }\r\n        if (this.buttonCancel.node.active) {\r\n            this.labelCancel.node.position = this.buttonCancel.node.position;\r\n            let getScale = MyMath.multiply(this.buttonCancel.node.scale.x, 0.5)\r\n            this.labelCancel.node.scale = v3(getScale, getScale, getScale);\r\n        }\r\n    }\r\n    setLanguage() {\r\n        this.labelConfirm.string = SocketSetting.t(\"1000\", LangType.Game)\r\n        this.labelCancel.string = SocketSetting.t(\"1001\", LangType.Game)\r\n        super.setLanguage()\r\n    }\r\n    showSingleConfirm(confirm?: ButtonFunctionApi) {\r\n        this.buttonConfirm.node.setPosition(0, -128);\r\n        if (confirm)\r\n            ButtonMng.addEvent(confirm.target, confirm.callback, this.buttonConfirm, confirm.callbackValue ? confirm.callbackValue : null);\r\n        else {\r\n            ButtonMng.clearEvent(this.buttonConfirm);\r\n            ButtonMng.addEvent(this, \"closeMessage\", this.buttonConfirm);\r\n        }\r\n        if (!this.buttonConfirm.node.active) {\r\n            this.buttonConfirm.node.active = true;\r\n            this.labelConfirm.node.active = true;\r\n        }\r\n    }\r\n\r\n    showSingleCancel(confirm?: ButtonFunctionApi) {\r\n        //取消按鈕\r\n        this.buttonCancel.node.setPosition(0, -128);\r\n        if (confirm)\r\n            ButtonMng.addEvent(confirm.target, confirm.callback, this.buttonConfirm, confirm.callbackValue ? confirm.callbackValue : null);\r\n        else {\r\n            ButtonMng.clearEvent(this.buttonCancel);\r\n            ButtonMng.addEvent(this, \"closeMessage\", this.buttonCancel);\r\n        }\r\n        if (!this.buttonCancel.node.active) {\r\n            this.buttonCancel.node.active = true;\r\n            this.labelCancel.node.active = true;\r\n        }\r\n    }\r\n    showDoubleButton(confirm: ButtonFunctionApi) {\r\n        // 確定按鈕\r\n        this.buttonConfirm.node.setPosition(this.twoBtnPositionX, -128);\r\n        ButtonMng.clearEvent(this.buttonConfirm);\r\n        ButtonMng.addEvent(confirm.target, confirm.callback, this.buttonConfirm, confirm.callbackValue ? confirm.callbackValue : null);\r\n        //取消按鈕\r\n        this.buttonCancel.node.setPosition(-this.twoBtnPositionX, -128);\r\n        ButtonMng.clearEvent(this.buttonCancel);\r\n        ButtonMng.addEvent(this, \"closeMessage\", this.buttonCancel);\r\n        if (!this.buttonCancel.node.active) {\r\n            this.buttonCancel.node.active = true;\r\n            this.labelCancel.node.active = true;\r\n        }\r\n        if (!this.buttonConfirm.node.active) {\r\n            this.buttonConfirm.node.active = true;\r\n            this.labelConfirm.node.active = true;\r\n        }\r\n    }\r\n    //暫時開通\r\n    onSystemMessage(caption: string, _buttonFunctionApi?: ButtonFunctionApi) {\r\n        this.messageInit(caption)\r\n        this.showSingleConfirm(_buttonFunctionApi)\r\n    }\r\n    closeMessage(caption: string, _buttonFunctionApi?: ButtonFunctionApi) {\r\n        this.hide()\r\n    }\r\n    closeWindow() {\r\n        this.eventEmit(WebSocketEvent.CloseWindow)\r\n    }\r\n    setCaption(caption: string) {\r\n        this.labelCaption.string = caption\r\n    }\r\n    messageInit(caption: string) {\r\n        this.buttonCancel.node.active = false;\r\n        this.labelCancel.node.active = false;\r\n        this.buttonConfirm.node.active = false;\r\n        this.labelConfirm.node.active = false;\r\n        this.setCaption(caption)\r\n        this.show()\r\n    }\r\n\r\n\r\n    countPosition() {\r\n        //計算間距\r\n        let spacing = MyMath.divide(find(\"SpriteBG\", this.nodeFrame).getComponent(UITransform).width, 2 + 1) //需要+1原因是要計算一個範圍內的平均值，去切割的話要+1才可得出\r\n        //計算圖片的一半\r\n        let half = MyMath.divide(find(\"SpriteBG\", this.nodeFrame).getComponent(UITransform).width, 2)\r\n        this.twoBtnPositionX = half - spacing\r\n        // console.log(this.twoBtnPositionX, spacing, half);\r\n    }\r\n}"]}
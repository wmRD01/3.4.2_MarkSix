{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Contorll/OldPj/%E6%9A%AB%E6%99%82%E4%B8%8D%E7%94%A8_PanelGameLoading.ts"],"names":["PanelGameLoading","find","Label","ProgressBar","Sprite","tween","UIOpacityComponent","v3","GameEvent","MyMath","BaseComponent","onLoad","progressBar","node","getComponent","sprite_Logo","label_progress","string","progress","setEvent","SetLogo","setLogo","CloseGameLoad","closeGameLoadAction","viewInit","show","_sprite","getUI","opacity","spriteFrame","getOrg","position","to","start","action","x","y","z","set","then","union","repeatForever","delay","call","destroy","onProgress","completedCount","totaleCount","item","console","log","divide","Math","floor","toString"],"mappings":"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","sourcesContent":["import { director, find, Label, ProgressBar, Sprite, SpriteFrame, tween, UIOpacityComponent, v3 } from 'cc';\r\nimport { GameEvent } from '../../Enum/GameEvent';\r\nimport MyMath from '../../../Plug/MyMath';\r\nimport BaseComponent from '../../Model/ComponentBase';\r\nexport default class PanelGameLoading extends BaseComponent {\r\n    progressBar: ProgressBar;\r\n    label_progress: Label;\r\n    sprite_Logo: Sprite;\r\n    onLoad() {\r\n        this.progressBar = find(\"ProgressBar\", this.node).getComponent(ProgressBar);\r\n        this.sprite_Logo = find(\"sprite_Logo\", this.node).getComponent(Sprite);\r\n        this.label_progress = find(\"con_Text/label_progress\", this.node).getComponent(Label);\r\n        this.label_progress.string = \"0%\"\r\n        this.progressBar.progress = 0\r\n        this.setEvent(GameEvent.SetLogo, this.setLogo)\r\n        this.setEvent(GameEvent.CloseGameLoad, this.closeGameLoadAction)\r\n\r\n        // director.preloadScene(\"MainGame\", this.onProgress.bind(this), () => {\r\n        //     CheckLoading.getInstance.changeState(CheckLoadingType.isGameSence, true)\r\n        //     if (CheckLoading.getInstance.checkAllEnd())\r\n        //         this.eventEmit(WebSocketEvent.Login, CommandType.ln)\r\n        // })\r\n        super.viewInit()\r\n        this.show()\r\n    }\r\n    setLogo(_sprite: SpriteFrame) {\r\n        let getUI = this.sprite_Logo.getComponent(UIOpacityComponent)\r\n        getUI.opacity = 0\r\n        this.sprite_Logo.spriteFrame = _sprite\r\n        let getOrg = this.sprite_Logo.node.position\r\n        tween(getUI)\r\n            .to(.5, { opacity: 255 })\r\n            .start()\r\n\r\n        let action = tween()\r\n            .to(1, { position: v3(getOrg.x, getOrg.y + 30, getOrg.z) })\r\n            .to(1, { position: v3(getOrg.x, getOrg.y - 30, getOrg.z) })\r\n\r\n        tween(this.sprite_Logo.node)\r\n            .set({ position: v3(getOrg.x, getOrg.y - 30, getOrg.z) })\r\n            .then(action)\r\n            .union()\r\n            .repeatForever()\r\n            .start()\r\n    }\r\n\r\n    closeGameLoadAction() {\r\n        tween(this.node)\r\n            .delay(1)\r\n            .call(() => {\r\n                this.node.destroy()\r\n            })\r\n            .start()\r\n    }\r\n    onProgress(completedCount: number, totaleCount: number, item: any) {\r\n        console.log(completedCount, totaleCount);\r\n\r\n        // console.log(MyMath.divide(completedCount, totaleCount));\r\n        // console.log(this.progressBar);\r\n\r\n        this.progressBar.progress = MyMath.divide(completedCount, totaleCount)\r\n\r\n        this.label_progress.string = Math.floor(MyMath.divide(completedCount, totaleCount) * 100).toString() + \"%\"\r\n\r\n        if (this.progressBar.progress >= 1) {\r\n            this.label_progress.string = \"wait other data\"\r\n        }\r\n    }\r\n}"]}
{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Model/CreateFileSprite.ts"],"names":["CreateFileSprite","ImageAsset","Size","SpriteFrame","Texture2D","constructor","_callback","_error","callback","errorback","document","getElementById","remove","input","createElement","type","accept","id","click","addEventListener","checkSpriteData","bind","head","appendChild","e","limitSize","setLimitSize","file","target","files","AcceptImgFormat","indexOf","size","reader","FileReader","onload","readerOnload","readAsDataURL","image","Image","data","result","src","imgAsset","reset","texture","sp","dataURLtoFile","dataurl","filename","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","compress","img","canvas","ctx","getContext","tCanvas","tctx","initSize","wid","hei","console","log","width","height","spec","AutoSize","ratio","Math","sqrt","fillStyle","fillRect","count","nw","nh","i","j","drawImage","ndata","toDataURL","maxWidth","maxHeight"],"mappings":"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","sourcesContent":["import { ImageAsset, Size, SpriteFrame, Texture2D } from \"cc\";\r\nimport { RequestGPG } from \"../Contorll/Api/GPGAPI/RequestGPG\";\r\n\r\nexport default class CreateFileSprite {\r\n    AcceptImgFormat: string[] = ['image/gif', 'image/jpeg', 'image/png', 'image/bmp'];\r\n    callback: Function\r\n    errorback: Function;\r\n    file: File;\r\n    setLimitSize: number = 5\r\n\r\n\r\n    constructor(_callback: Function, _error: Function) {\r\n        this.callback = _callback\r\n        this.errorback = _error\r\n        if (document.getElementById('inputfile') != null) {\r\n            document.getElementById('inputfile').remove();\r\n        }\r\n        let input = document.createElement('input');\r\n        input.type = \"file\";\r\n        input.accept = \"image/*\";\r\n        input.id = \"inputfile\";\r\n        input.click();\r\n        input.addEventListener(\"change\", this.checkSpriteData.bind(this), false);\r\n        document.head.appendChild(input);\r\n    }\r\n\r\n    checkSpriteData(e: Event) {\r\n        let limitSize = this.setLimitSize * 1024 * 1024\r\n        this.file = (e.target as HTMLInputElement).files[0]\r\n        if (this.AcceptImgFormat.indexOf(this.file.type) == -1) {\r\n            this.errorback(\"044\")\r\n            return\r\n        }\r\n        if (this.file.size > limitSize) {\r\n            this.errorback(\"043\")\r\n            return\r\n\r\n        }\r\n        if (!this.file) {\r\n            this.errorback(\"045\")\r\n            return\r\n        };\r\n        /**開一條支線傳給後端 */\r\n        const reader = new FileReader();\r\n        reader.onload = this.readerOnload.bind(this)\r\n        reader.readAsDataURL(this.file)\r\n    }\r\n\r\n    readerOnload(e: ProgressEvent) {\r\n        const image = new Image();\r\n        let data = (e.target as FileReader).result as string\r\n        image.src = data\r\n        // let _base64 = data.split(\",\")[1]\r\n        image.onload = () => {\r\n            let imgAsset = new ImageAsset();//重置此图像资源使用的原始图像源\r\n            imgAsset.reset(image);\r\n            let texture = new Texture2D();\r\n            texture.image = imgAsset;\r\n            const sp = new SpriteFrame();\r\n            //sprite 图片\r\n            sp.texture = texture;\r\n            // console.log(this.file);\r\n            this.callback(sp, this.file)\r\n            return\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n    /**以下暫時用不到，如果需要進一步處理圖片才需要 */\r\n    /**以下暫時用不到，如果需要進一步處理圖片才需要 */\r\n    /**以下暫時用不到，如果需要進一步處理圖片才需要 */\r\n    /**以下暫時用不到，如果需要進一步處理圖片才需要 */\r\n    /**以下暫時用不到，如果需要進一步處理圖片才需要 */\r\n    /**以下暫時用不到，如果需要進一步處理圖片才需要 */\r\n    /**以下暫時用不到，如果需要進一步處理圖片才需要 */\r\n\r\n\r\n    dataURLtoFile(dataurl: string, filename: string) { //將base64轉換為檔案\r\n        var arr = dataurl.split(','),\r\n            mime = arr[0].match(/:(.*?);/),\r\n            bstr = atob(arr[1]),\r\n            n = bstr.length,\r\n            u8arr = new Uint8Array(n);\r\n        while (n--) {\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        // return new File([u8arr], filename, {\r\n        //     type: mime\r\n        // });\r\n    }\r\n    compress(img) {\r\n\r\n        // 用於壓縮圖片的canvas\r\n        var canvas = document.createElement('canvas');\r\n        var ctx = canvas.getContext('2d');\r\n        // 瓦片canvas\r\n        var tCanvas = document.createElement('canvas');\r\n        var tctx = tCanvas.getContext('2d');\r\n        let initSize = img.src.length;\r\n\r\n        // 獲取父元素寬高\r\n        let wid = 207\r\n        let hei = 207\r\n        // let parentWh = $('.creater_class .files');\r\n        // let wid = parentWh.width();\r\n        // let hei = parentWh.height();\r\n        //console.log(\"父親:\"+wid+'...'+hei)\r\n        console.log(\"原始圖片:\" + img.width + '...' + img.height)\r\n        // 等比壓縮圖片\r\n        let spec = this.AutoSize(img, wid, hei);\r\n        var width = spec.width;\r\n        var height = spec.height;\r\n        console.log(\"變小圖片:\" + width + '...' + height)\r\n        // 如果圖片大於四百萬畫素，計算壓縮比並將大小壓至400萬以下\r\n        var ratio;\r\n        if ((ratio = width * height / 4000000) > 1) {\r\n            ratio = Math.sqrt(ratio);\r\n            width /= ratio;\r\n            height /= ratio;\r\n        } else {\r\n            ratio = 1;\r\n        }\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        // 鋪底色\r\n        ctx.fillStyle = '#000';\r\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n        // 如果圖片畫素大於100萬則使用瓦片繪製\r\n        var count;\r\n        if ((count = width * height / 1000000) > 1) {\r\n            count = ~~(Math.sqrt(count) + 1); // 計算要分成多少塊瓦片\r\n            // 計算每塊瓦片的寬和高\r\n            var nw = ~~(width / count);\r\n            var nh = ~~(height / count);\r\n            tCanvas.width = nw;\r\n            tCanvas.height = nh;\r\n            for (let i = 0; i < count; i++) {\r\n                for (let j = 0; j < count; j++) {\r\n                    tctx.drawImage(img, i * nw * ratio, j * nh * ratio, nw * ratio, nh * ratio, 0, 0, nw, nh);\r\n                    ctx.drawImage(tCanvas, i * nw, j * nh, nw, nh);\r\n                }\r\n            }\r\n        } else {\r\n            ctx.drawImage(img, 0, 0, width, height);\r\n        }\r\n\r\n        // 進行最小壓縮0.1\r\n        //var ndata = canvas.toDataURL('image/jpeg', 0.5);\r\n        var ndata = canvas.toDataURL();\r\n        // console.log('壓縮前：' + initSize)\r\n        // console.log('壓縮後：' + ndata.length)\r\n        // console.log('壓縮率：' + ~~(100 * (initSize - ndata.length) / initSize) + \"%\")\r\n        //tCanvas.width = tCanvas.height = canvas.width = canvas.height = 0;\r\n        return ndata;\r\n    }\r\n    AutoSize(image, maxWidth, maxHeight) { // 等比壓縮圖片\r\n        let spec = new Size();\r\n        // 當圖片比圖片框小時不做任何改變\r\n        if (image.width < maxWidth && image.height < maxHeight) {\r\n            //原圖片寬高比例 大於 圖片框寬高比例\r\n            //寬大於高\r\n            if (image.width >= image.height) {\r\n                spec.width = maxWidth;\r\n                spec.height = image.height * (maxWidth / image.width);\r\n            }\r\n            //高大於寬\r\n            else {\r\n                spec.width = image.width * (maxHeight / image.height);\r\n                spec.height = maxHeight;\r\n            }\r\n            // spec.width = image.width;\r\n            // spec.height = image.height;\r\n        } else {\r\n            //原圖片寬高比例 大於 圖片框寬高比例,則以框的寬為標準縮放，反之以框的高為標準縮放\r\n            if (maxWidth / maxHeight <= image.width / image.height) {\r\n                spec.width = maxWidth; //以框的寬度為標準\r\n                spec.height = maxWidth * (image.height / image.width);\r\n            } else {\r\n                spec.width = maxHeight * (image.width / image.height);\r\n                spec.height = maxHeight; //以框的高度為標準\r\n            }\r\n        }\r\n\r\n        return spec;\r\n    }\r\n}\r\n\r\n    // _doChangePhoto() {\r\n    //     // 取得選取的檔案\r\n    //     const selectedFile = document.getElementById('inputfile').files[0];\r\n\r\n    //     // 檢查檔案格式\r\n    //     if (!ShareControll.AllShare_Controll.publicSetUp.AcceptImgFormat.includes(selectedFile.type)) {\r\n    //         ShareControll.AllShare_Controll.MessageBox.showConfirm(this, 0, ShareControll.AllShare_Controll.publicSetUp.Lng_UploadFileFormat);\r\n    //         return false;\r\n    //     }\r\n\r\n    //     // 檢查檔案大小\r\n    //     if (selectedFile.size > ShareControll.AllShare_Controll.publicSetUp.FileSizeLimit * 1024 * 1024) {\r\n    //         ShareControll.AllShare_Controll.MessageBox.showConfirm(this, 0, ShareControll.AllShare_Controll.publicSetUp.Lng_ExceedFileSize);\r\n    //         return false;\r\n    //     }\r\n\r\n    //     // 讀取檔案內容\r\n    //     const reader = new FileReader();\r\n    //     reader.onload = function (event) {\r\n    //         // 建立圖片物件\r\n    //         const image = new Image();\r\n\r\n    //         // 設定圖片來源\r\n    //         image.src = event.target.result;\r\n\r\n    //         // 圖片載入後，執行下列程式碼\r\n    //         image.onload = function () {\r\n    //             // 檢查檔案大小是否超過限制\r\n    //             if (image.width > ShareControll.AllShare_Controll.publicSetUp.ImageWidthLimit || image.height > ShareControll.AllShare_Controll.publicSetUp.ImageHeightLimit) {\r\n    //                 ShareControll.AllShare_Controll.MessageBox.showConfirm(this, 0, ShareControll.AllShare_Controll.publicSetUp.Lng_ImageSizeExceed);\r\n    //                 return false;\r\n    //             }\r\n\r\n    //             // 壓縮圖片\r\n    //             const compressedImage = LobbyShareFuntion.compress(image);\r\n\r\n    //             // 將壓縮後的圖片儲存到檔案\r\n    //             const newFile = LobbyShareFuntion.dataURLtoFile(compressedImage, '1.png');\r\n\r\n    //             // 顯示圖片\r\n    //             LobbyShareFuntion.PreviewPhoto(image, compressedImage);\r\n    //         };\r\n    //     };\r\n\r\n    //     // 讀取檔案內容\r\n    //     reader.readAsDataURL(selectedFile);\r\n    // }"]}
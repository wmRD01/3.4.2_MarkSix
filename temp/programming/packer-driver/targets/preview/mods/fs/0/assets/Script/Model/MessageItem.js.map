{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Model/MessageItem.ts"],"names":["Label","Sprite","tween","UIOpacity","UITransform","v3","_decorator","BaseComponent","PublicModel","ccclass","property","MessageItem","start","spriteOpacity","sprite","getComponent","labelOpacity","label","moveUp","isFade","pos","node","getPosition","console","log","height","y","setPosition","outFade","delay","delayFadeTime","call","parallel","by","position","to","opacity","onComplete","destroyItem","bind","destroy","update","equals","getInstance","to2DConvertOtherNodeSpaceAR"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,K,OAAAA,K;AAAOC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,E,OAAAA,E;AAAUC,MAAAA,U,OAAAA,U;;AAC1DC,MAAAA,a;;AACAC,MAAAA,W;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U;;yBAETK,W,WADpBF,OAAO,CAAC,aAAD,C,UAEHC,QAAQ,CAACT,MAAD,C,UAERS,QAAQ,CAACV,KAAD,C,oCAJb,MACqBW,WADrB;AAAA;AAAA,0CACuD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,iDAO3B,CAP2B;;AAAA,0CAQjC,KARiC;AAAA;;AASnDC,QAAAA,KAAK,GAAG;AACJ,eAAKC,aAAL,GAAqB,KAAKC,MAAL,CAAYC,YAAZ,CAAyBZ,SAAzB,CAArB;AACA,eAAKa,YAAL,GAAoB,KAAKC,KAAL,CAAWF,YAAX,CAAwBZ,SAAxB,CAApB;AAEH;;AAEDe,QAAAA,MAAM,GAAG;AACL,cAAI,KAAKC,MAAT,EAAiB;AACjB,cAAIC,GAAG,GAAG,KAAKC,IAAL,CAAUC,WAAV,EAAV;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAKV,MAAL,CAAYC,YAAZ,CAAyBX,WAAzB,EAAsCqB,MAAlD;AAEAL,UAAAA,GAAG,CAACM,CAAJ,GAAQN,GAAG,CAACM,CAAJ,GAAQ,KAAKZ,MAAL,CAAYC,YAAZ,CAAyBX,WAAzB,EAAsCqB,MAAtD;AACA,eAAKJ,IAAL,CAAUM,WAAV,CAAsBP,GAAtB;AAEH;;AACDQ,QAAAA,OAAO,GAAG;AAEN1B,UAAAA,KAAK,CAAC,IAAD,CAAL,CACK2B,KADL,CACW,KAAKC,aADhB,EAEKC,IAFL,CAEU,MAAM;AACR,iBAAKZ,MAAL,GAAc,IAAd;AACAjB,YAAAA,KAAK,CAAC,KAAKmB,IAAN,CAAL,CACKW,QADL,CAEQ9B,KAAK,GACA+B,EADL,CACQ,EADR,EACY;AAAEC,cAAAA,QAAQ,EAAE7B,EAAE,CAAC,CAAD,EAAI,EAAJ,EAAQ,CAAR;AAAd,aADZ,CAFR,EAKQH,KAAK,GACA6B,IADL,CACU,MAAM;AACR7B,cAAAA,KAAK,CAAC,KAAKW,aAAN,CAAL,CACKsB,EADL,CACQ,EADR,EACY;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eADZ,EAC4B;AAAEC,gBAAAA,UAAU,EAAE,KAAKC,WAAL,CAAiBC,IAAjB,CAAsB,IAAtB;AAAd,eAD5B,EAEK3B,KAFL;AAGH,aALL,CALR,EAYKA,KAZL;AAaH,WAjBL,EAkBKA,KAlBL;AAmBH;;AAED0B,QAAAA,WAAW,GAAG;AACV,eAAKrB,KAAL,CAAWI,IAAX,CAAgBmB,OAAhB;AACA,eAAKnB,IAAL,CAAUmB,OAAV;AACA,eAAKA,OAAL;AACH;;AAEDC,QAAAA,MAAM,GAAG;AACL,cAAI,CAAC,KAAKxB,KAAL,CAAWI,IAAX,CAAgBa,QAAhB,CAAyBQ,MAAzB,CAAgC;AAAA;AAAA,0CAAYC,WAAZ,CAAwBC,2BAAxB,CAAoD,KAAK3B,KAAL,CAAWI,IAA/D,EAAqE,KAAKA,IAA1E,CAAhC,CAAL,EACI,KAAKJ,KAAL,CAAWI,IAAX,CAAgBa,QAAhB,GAA2B;AAAA;AAAA,0CAAYS,WAAZ,CAAwBC,2BAAxB,CAAoD,KAAK3B,KAAL,CAAWI,IAA/D,EAAqE,KAAKA,IAA1E,CAA3B;AACJ,cAAI,KAAKL,YAAL,CAAkBoB,OAAlB,IAA6B,KAAKvB,aAAL,CAAmBuB,OAApD,EACI,KAAKpB,YAAL,CAAkBoB,OAAlB,GAA4B,KAAKvB,aAAL,CAAmBuB,OAA/C;AACP;;AA1DkD,O","sourcesContent":["import { Label, Sprite, tween, UIOpacity, UITransform, v3, Vec3, _decorator } from \"cc\";\r\nimport BaseComponent from \"./ComponentBase\";\r\nimport PublicModel from \"./PublicModel\";\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('MessageItem')\r\nexport default class MessageItem extends BaseComponent {\r\n    @property(Sprite)\r\n    sprite: Sprite;\r\n    @property(Label)\r\n    label: Label;\r\n    spriteOpacity: UIOpacity\r\n    labelOpacity: UIOpacity\r\n    delayFadeTime: number = 2;\r\n    isFade: boolean = false\r\n    start() {\r\n        this.spriteOpacity = this.sprite.getComponent(UIOpacity)\r\n        this.labelOpacity = this.label.getComponent(UIOpacity)\r\n\r\n    }\r\n\r\n    moveUp() {\r\n        if (this.isFade) return\r\n        let pos = this.node.getPosition()\r\n        console.log(this.sprite.getComponent(UITransform).height);\r\n\r\n        pos.y = pos.y + this.sprite.getComponent(UITransform).height\r\n        this.node.setPosition(pos)\r\n\r\n    }\r\n    outFade() {\r\n\r\n        tween(this)\r\n            .delay(this.delayFadeTime)\r\n            .call(() => {\r\n                this.isFade = true\r\n                tween(this.node)\r\n                    .parallel(\r\n                        tween()\r\n                            .by(.5, { position: v3(0, 50, 0) })\r\n                        ,\r\n                        tween()\r\n                            .call(() => {\r\n                                tween(this.spriteOpacity)\r\n                                    .to(.5, { opacity: 0 }, { onComplete: this.destroyItem.bind(this) })\r\n                                    .start()\r\n                            })\r\n                    )\r\n                    .start()\r\n            })\r\n            .start()\r\n    }\r\n\r\n    destroyItem() {\r\n        this.label.node.destroy()\r\n        this.node.destroy()\r\n        this.destroy()\r\n    }\r\n\r\n    update() {\r\n        if (!this.label.node.position.equals(PublicModel.getInstance.to2DConvertOtherNodeSpaceAR(this.label.node, this.node)))\r\n            this.label.node.position = PublicModel.getInstance.to2DConvertOtherNodeSpaceAR(this.label.node, this.node)\r\n        if (this.labelOpacity.opacity != this.spriteOpacity.opacity)\r\n            this.labelOpacity.opacity = this.spriteOpacity.opacity\r\n    }\r\n}"]}
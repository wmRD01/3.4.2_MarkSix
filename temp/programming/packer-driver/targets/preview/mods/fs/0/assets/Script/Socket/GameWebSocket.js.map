{"version":3,"sources":["file:///C:/CocosProject/3.4.2_MarkSix/assets/Script/Socket/GameWebSocket.ts"],"names":["Config","log","sys","_decorator","ln","URLVlaue","MessageCommend","LangType","CheckLoadingType","CommandType","WebSocketEvent","PublicData","SocketModel","SocketSetting","DelayTime","CheckLoading","GameData","Player","PublicModel","GameControll","WebPlatform","ccclass","property","GameWebSocket","onEnable","eventSetting","judgePlatorm","Setting","MotifySetting","console","window","isGPGServer","getInstance","isChageOnline","startConnect","checkState","isWebSocketOpen","node","destroy","isFirstData","getWebPlatform","Default","RomoteData","libPath","gameID","Date","getTime","connectToServer","bind","loadLanguageError","test","from","data","push","jsonText","jsonTo","JSON","parse","TwoClassCheckData","host","connectionType","serverhost","serverport","webSocket","WebSocket","onopen","onWS_Open","onerror","onWS_Error","onclose","onWS_Close","onmessage","onWS_Receive","setControllEvent","setEvent","StartConnect","Login","onLogIn","WebSocketSendCommand","onSend","BackHome","onBackHome","CloseWindow","onCloseWindow","ViewRecord","onViewRecord","StaoredValue","onStaoredValue","StartLoadLanguage","startLoadLanguage","CloseWebSocket","closeWebsocket","cmd","isClose","StartDT_NotClear","undefined","config","send","stringify","_ln","gameId","isInpokerServer","urlData","_gameConfig","account","memberid","key","token","gpgToken","coinType","recodeUrl","recordeURL","language","UserLanguage","event","endWork","usertoken","resetState","message","jmsg","serverRespond","e","formatRecordUrl","agentId","open","backHomeURL","document","location","href","staoredValueUrl","temp","close","usdis","StopGameHeartrate","search","length","getsearch","split","urldata","getsearchKey","searchList","datakey","url","callback","errCallback","platform","Platform","ANDROID","result","jsb","fileUtils","getStringFromFile","Error","xhr","XMLHttpRequest","errInfo","overrideMimeType","onload","readyState","status","response","ontimeout","androidLoadLanguage","getText","gameLang","loadLanguageEnd","serverLang","serverAPILang","type","indexOf","Game","Server","ServerAPI","setLang","init","err","loadLanguageCount","loadLanguageErrorAgain","messaggeState"],"mappings":"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","sourcesContent":["import { game, log, sys, _decorator } from \"cc\";\r\nimport { ln, URLVlaue } from \"../Contorll/Api/SendCommand\";\r\nimport { MessageCommend } from \"../Enum/MessageCommend\";\r\nimport { LangType } from \"../Enum/LangType\";\r\nimport { CheckLoadingType } from \"../Enum/CheckLoadingType\";\r\nimport { CommandType } from \"../Enum/CommandType\";\r\nimport { WebSocketEvent } from \"../Enum/WebSocketEvent\";\r\nimport PublicData from \"../Model/PublicData\";\r\nimport SocketModel from \"../Model/SocketModel\";\r\nimport SocketSetting from \"./SocketSetting\";\r\nimport DelayTime from '../../Plug/DelayTime';\r\nimport CheckLoading from \"../Model/CheckLoading\";\r\nimport GameData from \"../Model/GameData\";\r\nimport Player from \"../Model/Player\";\r\nimport PublicModel from \"../Model/PublicModel\";\r\nimport GameControll from \"../Contorll/GameControll/GameControll\";\r\nimport { WebPlatform } from \"../Enum/WebPlatform\";\r\nimport BaseSingleton from \"../../Patten/Singleton/BaseSingleton\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameWebSocket')\r\nexport default class GameWebSocket extends SocketModel {\r\n    isFirstData: boolean = true\r\n\r\n    onEnable() {\r\n        this.eventSetting();\r\n        this.judgePlatorm();\r\n        this.Setting();\r\n        this.MotifySetting()\r\n        console.log(window.isGPGServer);\r\n\r\n        if (window.isGPGServer)\r\n            PublicData.getInstance.isChageOnline();\r\n\r\n    }\r\n    startConnect(): void {\r\n        /**避免測試期間轉換到下一個場景的時候，又再次連線 */\r\n\r\n        if (CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            this.node.destroy()\r\n            return\r\n        }\r\n        if (this.isFirstData) {\r\n\r\n\r\n\r\n            let getWebPlatform = WebPlatform.Default\r\n            /**由於打包出去後似乎會被意外轉成Obj，因此還要再次判斷 */\r\n            getWebPlatform = typeof getWebPlatform !== 'string' ? WebPlatform.Default : getWebPlatform\r\n            // console.error(\"最終結果：\" + getWebPlatform);\r\n            //取得config拿取遊戲相關資料，其中包含連線的資訊\r\n            this.RomoteData(`${this.libPath}config/${GameData.getInstance.gameID}/${getWebPlatform}/game.json?${new Date().getTime()}`, this.connectToServer.bind(this), this.loadLanguageError.bind(this))\r\n            // AssetMng.loadLogoAsset(this.UserLanguage)\r\n        }\r\n        else\r\n            this.connectToServer();\r\n    }\r\n\r\n    test(from: Array<number>, data) {\r\n        from.push(data)\r\n    }\r\n    connectToServer(jsonText?: string) {\r\n        if (jsonText) {\r\n            let jsonTo = JSON.parse(jsonText)\r\n            console.log(jsonTo);\r\n            PublicModel.getInstance.TwoClassCheckData(GameData.getInstance, jsonTo)\r\n            PublicModel.getInstance.TwoClassCheckData(this, jsonTo)\r\n\r\n        }\r\n        let host = `${this.connectionType}://${this.serverhost}:${this.serverport}`;\r\n        console.log(host);\r\n        this.webSocket = new WebSocket(host)\r\n        this.webSocket.onopen = this.onWS_Open.bind(this);\r\n        this.webSocket.onerror = this.onWS_Error.bind(this);\r\n        this.webSocket.onclose = this.onWS_Close.bind(this);\r\n        this.webSocket.onmessage = this.onWS_Receive.bind(this);\r\n    }\r\n\r\n    eventSetting() {\r\n        console.log(\"監聽設定玩\");\r\n        console.log(GameControll.getInstance);\r\n\r\n        GameControll.getInstance.setControllEvent()\r\n        console.log(\"監聽設定玩\");\r\n\r\n        this.setEvent(WebSocketEvent.StartConnect, this.startConnect);\r\n        this.setEvent(WebSocketEvent.Login, this.onLogIn);\r\n        this.setEvent(WebSocketEvent.WebSocketSendCommand, this.onSend);\r\n        this.setEvent(WebSocketEvent.BackHome, this.onBackHome);\r\n        this.setEvent(WebSocketEvent.CloseWindow, this.onCloseWindow)\r\n        this.setEvent(WebSocketEvent.ViewRecord, this.onViewRecord)\r\n        this.setEvent(WebSocketEvent.StaoredValue, this.onStaoredValue)\r\n        this.setEvent(WebSocketEvent.StartLoadLanguage, this.startLoadLanguage)\r\n        this.setEvent(WebSocketEvent.CloseWebSocket, this.closeWebsocket)\r\n        console.log(\"監聽設定玩\");\r\n\r\n    }\r\n\r\n    async onSend(cmd, data) {\r\n        if (!CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            if (this.isClose) return\r\n\r\n            log(\"等待連線.......\")\r\n            await DelayTime.getInstance.StartDT_NotClear(0.5)\r\n            this.onSend(cmd, data)\r\n            return;\r\n        }\r\n        if (cmd == undefined || cmd == \"\") return;\r\n        let config = new Config();\r\n        config.cmd = cmd;\r\n        config.data = data || null;\r\n        console.log(' \\n=====送=====');\r\n        console.log(\">> cmd: \" + cmd);\r\n        console.log(\">> data: \", data);\r\n        console.log('=====送=====\\n ');\r\n        // console.log(JSON.stringify(config));\r\n        this.webSocket.send(JSON.stringify(config));\r\n    }\r\n\r\n\r\n\r\n    onLogIn(cmd) {\r\n        let _ln = new ln()\r\n        _ln.gameId = GameData.getInstance.gameID\r\n        if ((window.isGPGServer || window.isInpokerServer) && this.urlData != undefined) {\r\n            let _gameConfig = new URLVlaue()\r\n            PublicModel.getInstance.TwoClassCheckData(_gameConfig, this.urlData);\r\n\r\n            this.account = _gameConfig.memberid\r\n            _ln.account = this.account\r\n            _ln.key = _gameConfig.token;\r\n        }\r\n        else if (this.urlData != undefined) {\r\n            let _gameConfig = new URLVlaue()\r\n            PublicModel.getInstance.TwoClassCheckData(_gameConfig, this.urlData);\r\n\r\n            this.account = _gameConfig.memberid\r\n            _ln.account = this.account\r\n            _ln.key = _gameConfig.token;\r\n        }\r\n        // //TODO 直接給token字串\r\n        // else if (window.isGPGServer)\r\n        //     _ln.key = JSON.stringify({})\r\n        // //TODO 修改成menberID的給Leo\r\n        else {\r\n            _ln.account = this.account\r\n            _ln.key = Player.getInstance.gpgToken;\r\n\r\n        }\r\n        GameData.getInstance.coinType = this.coinType;\r\n        PublicData.getInstance.recodeUrl = this.recordeURL;\r\n        PublicData.getInstance.language = this.UserLanguage\r\n        console.log(_ln, \"入房資訊\");\r\n        this.onSend(cmd, _ln)\r\n        this.isFirstData = false\r\n    }\r\n\r\n\r\n    /////////////////////////////////////////////////////////////\r\n    ///     web socket event.\r\n    /////////////////////////////////////////////////////////////\r\n    //#region  \r\n    onWS_Open(event) {\r\n        console.log(\"Send Text WS was opened.\");\r\n        CheckLoading.getInstance.endWork(CheckLoadingType.isWebSocketOpen);\r\n        this.onLogIn(\"ln\")\r\n        if (this.usertoken == \"\") {\r\n            // GameControll.getInstance.messaggeState(MessageCommend.BackHome, SocketSetting.t(\"E_0001\", LangType.Game))\r\n            return;\r\n        }\r\n    }\r\n    onWS_Error(event) {\r\n        console.log(\"Send Text fired an error\");\r\n        CheckLoading.getInstance.resetState(CheckLoadingType.isWebSocketOpen);\r\n        // 連線錯誤，詳細情況請洽客服!\r\n        // GameControll.getInstance.messaggeState(MessageCommend.BackHome, SocketSetting.t(\"E_0001\", LangType.Game))\r\n    }\r\n    onWS_Close(event) {\r\n        console.log(\"WebSocket instance closed.\");\r\n        this.isClose = true\r\n        if (CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            CheckLoading.getInstance.resetState(CheckLoadingType.isWebSocketOpen);\r\n            // GameControll.getInstance.messaggeState(MessageCommend.BackHome, SocketSetting.t(\"E_0002\", LangType.Game))\r\n        };\r\n    }\r\n    onWS_Receive(event) {\r\n        let message = event.data;\r\n        try {\r\n            let jmsg = JSON.parse(message);\r\n            // console.log(jmsg);\r\n\r\n            if (typeof jmsg == \"object\") {\r\n                console.log(' \\n=====收=====');\r\n                console.log(\">> cmd: \" + jmsg.cmd);\r\n                console.log(jmsg.data);\r\n                console.log('=====收=====\\n ');\r\n                GameControll.getInstance.serverRespond(jmsg.cmd, jmsg.data);\r\n                return;\r\n            }\r\n        } catch (e) { }\r\n\r\n    }\r\n    //#endregion\r\n\r\n    onViewRecord() {\r\n        if (this.recordeURL != null && this.recordeURL != \"\" && this.recordeURL != \"undefined\") {\r\n            let formatRecordUrl = `${this.recordeURL}?agentId=${this.agentId}&playerId=${Player.getInstance.account}&lang=${this.UserLanguage}`\r\n            window.open(formatRecordUrl)\r\n        }\r\n    }\r\n    onBackHome() {\r\n        /**通知server斷線 */\r\n        // this.onSend(CommandType.usdis, {})\r\n        if (this.backHomeURL != null && this.backHomeURL != \"\" && this.backHomeURL != \"undefined\") {\r\n            document.location.href = this.backHomeURL;\r\n        }\r\n    }\r\n    onStaoredValue() {\r\n        if (this.staoredValueUrl != null && this.staoredValueUrl != \"\" && this.staoredValueUrl != \"undefined\") {\r\n            window.open(this.staoredValueUrl)\r\n        }\r\n    }\r\n    onCloseWindow() {\r\n        let temp = window.open('', '_self');\r\n        temp.close();\r\n    }\r\n    closeWebsocket() {\r\n        // this.isClose = true\r\n        // CheckLoading.getInstance.resetState(CheckLoadingType.isWebSocketOpen);\r\n\r\n        if (!CheckLoading.getInstance.checkState(CheckLoadingType.isWebSocketOpen)) {\r\n            return\r\n        }\r\n\r\n        this.onSend(CommandType.usdis, {})\r\n        DelayTime.getInstance.StopGameHeartrate();\r\n    }\r\n    /////////////////////////////////////////////////////////////\r\n    ///     lang載入設定.\r\n    /////////////////////////////////////////////////////////////\r\n\r\n    // server可自改語言與伺服器\r\n    MotifySetting() {\r\n        if ((window.location.search).length > 0) {\r\n            var getsearch: Array<string> = window.location.search.split('?');\r\n            var urldata: object = {};\r\n            for (var getsearchKey in getsearch) {\r\n                if (getsearch[getsearchKey] != \"\") {\r\n                    let searchList: Array<string> = getsearch[getsearchKey].split('&');\r\n                    for (var key in searchList) {\r\n                        urldata[searchList[key].split('=')[0]] = searchList[key].split('=')[1];\r\n                        /**這是要判斷是否強改資料的部分，改的話就不要套用DB給的資料 */\r\n                        for (var datakey in urldata) {\r\n                            if (datakey == \"L\" || datakey == \"l\") {\r\n                                this.UserLanguage = urldata[datakey];\r\n                                this.urlData = undefined\r\n                            }\r\n                            if (datakey == \"S\" || datakey == \"s\") {\r\n                                this.serverhost = urldata[datakey];\r\n                                this.urlData = undefined\r\n                            }\r\n                            if (datakey == \"P\" || datakey == \"p\") {\r\n                                this.serverport = urldata[datakey];\r\n                                this.urlData = undefined\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    RomoteData(url: string, callback: Function, errCallback: Function) {\r\n        var url = url;\r\n        console.log('downloadText.url:', url);\r\n        // console.log(url.startsWith(\"http://\"));\r\n        // console.log(sys.platform);\r\n        if (sys.platform === sys.Platform.ANDROID) {\r\n\r\n            var result = jsb.fileUtils.getStringFromFile(url);\r\n            if (typeof result === 'string' && result) {\r\n                return result;\r\n            }\r\n            else {\r\n                return new Error('Download text failed: ' + url);\r\n            }\r\n\r\n        } else {\r\n            if (callback) {\r\n                // console.log('downloadText getXMLHttpRequest')\r\n                var xhr = new XMLHttpRequest(),\r\n                    errInfo = 'Load text file failed: ' + url;\r\n                xhr.open('GET', url, true);\r\n                if (xhr.overrideMimeType) xhr.overrideMimeType('text\\/plain; charset=utf-8');\r\n                xhr.onload = function () {\r\n                    if (xhr.readyState === 4) {\r\n                        if (xhr.status === 200 || xhr.status === 0) {\r\n                            callback(xhr.response, url);\r\n                        }\r\n                        else {\r\n                            errCallback(url)\r\n                            // errCallback({ status: xhr.status, errorMessage: errInfo + '(wrong status)' });\r\n                        }\r\n                    }\r\n                    else {\r\n                        errCallback(url)\r\n                        // errCallback({ status: xhr.status, errorMessage: errInfo + '(wrong readyState)' });\r\n                    }\r\n                };\r\n                xhr.onerror = function () {\r\n                    errCallback(url)\r\n                    // errCallback({ status: xhr.status, errorMessage: errInfo + '(error)' });\r\n                };\r\n                xhr.ontimeout = function () {\r\n                    errCallback(url)\r\n                    // errCallback({ status: xhr.status, errorMessage: errInfo + '(time out)' });\r\n                };\r\n                xhr.send(null);\r\n            }\r\n        }\r\n    }\r\n    androidLoadLanguage(getText) {\r\n        let jsonTo = JSON.parse(getText)\r\n        // console.log(jsonTo);\r\n    }\r\n    startLoadLanguage() {\r\n        console.log(\"開始讀\");\r\n\r\n        let gameLang = `${this.libPath}gameLanguage/${GameData.getInstance.gameID}/${this.UserLanguage}.json?/${new Date().getTime()}`\r\n        this.RomoteData(gameLang, this.loadLanguageEnd.bind(this), this.loadLanguageError.bind(this))\r\n        let serverLang = this.libPath + \"serverLanguage/\" + this.UserLanguage + \".json?\" + new Date().getTime()\r\n        this.RomoteData(serverLang, this.loadLanguageEnd.bind(this), this.loadLanguageError.bind(this))\r\n        let serverAPILang = this.libPath + \"serverApiLanguage/\" + this.UserLanguage + \".json?\" + new Date().getTime()\r\n        this.RomoteData(serverAPILang, this.loadLanguageEnd.bind(this), this.loadLanguageError.bind(this))\r\n\r\n    }\r\n    loadLanguageEnd(jsonText: string, url?: string) {\r\n        console.log(\"loadLanguageEnd\");\r\n        let type;\r\n        if (url.indexOf(\"gameLanguage\") > 0)\r\n            type = LangType.Game\r\n        if (url.indexOf(\"serverLanguage\") > 0)\r\n            type = LangType.Server\r\n        if (url.indexOf(\"serverApiLanguage\") > 0)\r\n            type = LangType.ServerAPI\r\n        let jsonTo = JSON.parse(jsonText)\r\n        SocketSetting.setLang(this.UserLanguage).init(jsonTo, type); //設定語言   \r\n        // SocketSetting.setLang(MyWebSocket.instence.UserLanguage).init(jsonTo, type); //設定語言   \r\n        // MainModelUp.instance.IsLoadLanguage = true;\r\n    }\r\n    loadLanguageError(url: string, err?: string) {\r\n        // console.log(\"loadLanguageError\");\r\n        if (err)\r\n            // console.log(\"錯誤?\" + err);\r\n\r\n            this.loadLanguageCount = 0;\r\n        this.RomoteData(url, this.loadLanguageEnd.bind(this), this.loadLanguageErrorAgain.bind(this));\r\n    }\r\n    loadLanguageErrorAgain(url: string) {\r\n        this.isClose = true\r\n        // console.log(\"语言包下载失败请通知客服\");\r\n        GameControll.getInstance.messaggeState(MessageCommend.BackHome, \"資源包有問題，請洽客服\")\r\n        // Panel_Message.showConfirm(this, 1, SocketSetting.t(\"S_9077\"), (e) => {\r\n        //     this.onBackHome();\r\n        // }); //\"语言包下载失败请通知客服\";\r\n        // MainModelUp.instance.ShowMessageBox = true;\r\n    }\r\n}\r\n\r\n\r\n\r\nclass Config {\r\n    cmd: string;\r\n    data: any;\r\n}\r\n\r\n// export default new MyWebSocket();\r\n\r\n\r\n// /**\r\n//  * 舊方法\r\n//  * \r\n//  */\r\n// loadScript(url, callback, callBackError) {\r\n//     console.log(url, callback, callBackError);\r\n\r\n//     var script = document.createElement(\"script\");\r\n//     console.log(script);\r\n\r\n//     script.type = \"text/javascript\";\r\n//     if (typeof (callback) != \"undefined\") {\r\n//         //@ts-ignore\r\n//         if (script.readyState) {\r\n//             //@ts-ignore\r\n//             script.onreadystatechange = function () {\r\n//                 //@ts-ignore\r\n//                 if (script.readyState == \"loaded\" || script.readyState == \"complete\") {\r\n//                     //@ts-ignore\r\n//                     script.onreadystatechange = null;\r\n//                     callback();\r\n//                 }\r\n//             };\r\n//         } else {\r\n//             script.onload = function () {\r\n//                 callback();\r\n//             };\r\n//             script.onerror = function (e) {\r\n//                 console.log(e);\r\n\r\n//                 if (MyWebSocket.instence.loadLanguageCount < 1) {\r\n//                     MyWebSocket.instence.loadScript(url, callback, callBackError);\r\n//                     MyWebSocket.instence.loadLanguageCount++;\r\n//                 } else {\r\n//                     callBackError();\r\n//                 }\r\n//             };\r\n//         }\r\n//     }\r\n//     script.src = url;\r\n//     document.body.appendChild(script);\r\n//     console.log(document.body);\r\n\r\n// }\r\n// /**\r\n//  * 舊方法\r\n//  * \r\n//  */\r\n// LoadLanguage(_language) {\r\n//     console.log(\"LoadLanguage\");\r\n\r\n//     // let LanguageURI = this.loadLanguage + this.UserLanguage + \".js?\" + new Date().getTime();\r\n//     let LanguageURI = this.loadLanguage + this.UserLanguage + \".js\";\r\n\r\n//     this.loadScript(LanguageURI, this.loadLanguageEnd, this.loadLanguageError);\r\n\r\n// }"]}